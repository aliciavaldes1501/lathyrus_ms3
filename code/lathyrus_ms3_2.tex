% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Lathyrus ms3: Selective agents},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering

\title{Lathyrus ms3: Selective agents}
\author{}
\date{\vspace{-2.5em}}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{4}
\tableofcontents
}
\hypertarget{data-preparation}{%
\section{Data preparation}\label{data-preparation}}

Load data, keep variables needed and merge

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data_selag<-}\KeywordTok{read.table}\NormalTok{(}\StringTok{"C:/Users/user/Dropbox/SU/Projects/lathyrus/lathyrus_ms1/data/clean/alldata_weather_subs.csv"}\NormalTok{,}\DataTypeTok{header=}\NormalTok{T,}\DataTypeTok{sep=}\StringTok{"}\CharTok{\textbackslash{}t}\StringTok{"}\NormalTok{,}\DataTypeTok{dec=}\StringTok{"."}\NormalTok{) }
\NormalTok{mean_weather<-}\KeywordTok{read.table}\NormalTok{(}\StringTok{"C:/Users/user/Dropbox/SU/Projects/lathyrus/lathyrus_ms1/data/clean/mean_weather.csv"}\NormalTok{,}\DataTypeTok{header=}\NormalTok{T,}\DataTypeTok{sep=}\StringTok{"}\CharTok{\textbackslash{}t}\StringTok{"}\NormalTok{,}\DataTypeTok{dec=}\StringTok{"."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data_selag<-data_selag[}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{7}\NormalTok{,}\DecValTok{9}\OperatorTok{:}\DecValTok{10}\NormalTok{,}\DecValTok{12}\NormalTok{,}\DecValTok{14}\OperatorTok{:}\DecValTok{15}\NormalTok{,}\DecValTok{17}\OperatorTok{:}\DecValTok{18}\NormalTok{,}\DecValTok{21}\NormalTok{,}\DecValTok{22}\NormalTok{)]}
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{n_fl<-data_selag}\OperatorTok{$}\NormalTok{cum_n_fl}
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{cum_n_fl<-}\OtherTok{NULL}
\NormalTok{mean_weather<-mean_weather[}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{115}\OperatorTok{:}\DecValTok{118}\NormalTok{)]}
\NormalTok{data_selag<-}\KeywordTok{merge}\NormalTok{(data_selag,mean_weather,}\DataTypeTok{by=}\StringTok{"year"}\NormalTok{)}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{arrange}\NormalTok{(.,id)}

\NormalTok{data_selag<-}\KeywordTok{anti_join}\NormalTok{(data_selag,}\KeywordTok{subset}\NormalTok{(data_selag,}\KeywordTok{is.na}\NormalTok{(FFD)}\OperatorTok{&}\KeywordTok{is.na}\NormalTok{(grazing)}\OperatorTok{&}
\StringTok{                                          }\KeywordTok{is.na}\NormalTok{(shoot_vol)}\OperatorTok{&}\KeywordTok{is.na}\NormalTok{(n_fr)}\OperatorTok{&}\KeywordTok{is.na}\NormalTok{(n_ovules)}\OperatorTok{&}
\StringTok{                                          }\KeywordTok{is.na}\NormalTok{(n_seeds)}\OperatorTok{&}\KeywordTok{is.na}\NormalTok{(n_intact_seeds)}\OperatorTok{&}
\StringTok{                                          }\KeywordTok{is.na}\NormalTok{(n_fl))) }\CommentTok{# Remove rows with all these NAs}
\NormalTok{data_selag<-}\KeywordTok{subset}\NormalTok{(data_selag,year}\OperatorTok{!=}\DecValTok{1995}\NormalTok{) }\CommentTok{# Remove data from 1995 because of problems with predation}
\KeywordTok{names}\NormalTok{(data_selag)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "year"           "FFD"            "id"             "ruta"          
##  [5] "genet"          "data"           "vernal"         "grazing"       
##  [9] "shoot_vol"      "n_fr"           "n_ovules"       "FFD_corr"      
## [13] "period"         "n_seeds"        "n_intact_seeds" "n_fl"          
## [17] "mean_3"         "mean_4"         "mean_5"         "mean_6"
\end{verbatim}

List of variables in data set:

\begin{itemize}
\tightlist
\item
  year
\item
  FFD: first flowering date (as number of days from vernal equinox)
\item
  id: individual identifier (including ``old'' for individuals in period
  1987-1996 and ``new'' for individuals in period 2006-2017)
\item
  ruta, genet: identifiers for plots and ids in old data
\item
  data: 1 if data available, 0 if not
\item
  vernal: date of vernal equinox in each year
\item
  grazing: proportion of grazing by deer
\item
  shoot\_vol: shoot volume
\item
  n\_fr: number of fruits
\item
  n\_ovules: number of ovules
\item
  FFD\_corr: first flowering date (as a date)
\item
  period: ``old'' for 1987-1996 and ``new'' for 2006-2017
\item
  n\_seeds: number of seeds
\item
  n\_intact\_seeds: number of intact (non-predated) seeds
\item
  n\_fl: number of flowers
\item
  mean\_3/4/5/6: average of daily mean temperatures for
  March/April/May/June
\end{itemize}

Interactions that we will focus on:

\begin{itemize}
\tightlist
\item
  Pollination: number of seeds per flower
\item
  Seed predation: proportion of seeds escaping predation
\item
  Grazing (by deer) before flowering: proportion of grazing
\end{itemize}

Calculate fruit set, seed set, number of seeds per fruit, number of
seeds per flower, proportion of predated seeds

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data_selag<-data_selag}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{fruit_set=}\NormalTok{n_fr}\OperatorTok{/}\NormalTok{n_fl,}\DataTypeTok{seed_set=}\KeywordTok{ifelse}\NormalTok{(fruit_set}\OperatorTok{==}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,n_seeds}\OperatorTok{/}\NormalTok{n_ovules),}
         \DataTypeTok{n_seeds_per_fr=}\KeywordTok{ifelse}\NormalTok{(fruit_set}\OperatorTok{==}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,n_seeds}\OperatorTok{/}\NormalTok{n_fr),}
         \DataTypeTok{n_seeds_per_fl=}\NormalTok{n_seeds}\OperatorTok{/}\NormalTok{n_fl,}
         \DataTypeTok{prop_seeds_esc=}\KeywordTok{ifelse}\NormalTok{(n_seeds}\OperatorTok{==}\DecValTok{0}\NormalTok{,}\OtherTok{NA}\NormalTok{,}\DecValTok{1}\OperatorTok{-}\NormalTok{((n_seeds}\OperatorTok{-}\NormalTok{n_intact_seeds)}\OperatorTok{/}\NormalTok{n_seeds)),}
         \DataTypeTok{prop_pred_seeds=}\KeywordTok{ifelse}\NormalTok{(n_seeds}\OperatorTok{==}\DecValTok{0}\NormalTok{,}\OtherTok{NA}\NormalTok{,(n_seeds}\OperatorTok{-}\NormalTok{n_intact_seeds)}\OperatorTok{/}\NormalTok{n_seeds),}
         \DataTypeTok{n_pred_seeds=}\NormalTok{n_seeds}\OperatorTok{-}\NormalTok{n_intact_seeds)}
\end{Highlighting}
\end{Shaded}

Using only mean temperatures. Using grazing as a proportion, and for
2008-2015 use values of proportion of aboveground volume. - 1987-1996:
grazing = proportion of flowers removed - 2006: grazing = proportion of
grazed shoots - 2007-2015: grazing = proportion of aboveground volume
removed - 2016-2017: grazing = proportion of flowers removed

Calculate successes/failures for grazing

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{grazing_success<-}\KeywordTok{round}\NormalTok{(}\KeywordTok{with}\NormalTok{(data_selag,}\KeywordTok{ifelse}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(grazing_corr),}\OtherTok{NA}\NormalTok{,}
                                                   \KeywordTok{ifelse}\NormalTok{(year}\OperatorTok{<}\DecValTok{1997}\OperatorTok{|}\NormalTok{year}\OperatorTok{>}\DecValTok{2015}\NormalTok{,grazing_corr}\OperatorTok{*}\NormalTok{n_fl,}
                                                   \KeywordTok{ifelse}\NormalTok{(year}\OperatorTok{>}\DecValTok{2006}\OperatorTok{&}\NormalTok{year}\OperatorTok{<}\DecValTok{2016}\NormalTok{,grazing_corr}\OperatorTok{*}\NormalTok{shoot_vol,}
                                                          \DecValTok{999}\NormalTok{)))))}
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{grazing_failure<-}\KeywordTok{round}\NormalTok{(}\KeywordTok{with}\NormalTok{(data_selag,}\KeywordTok{ifelse}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(grazing_corr),}\OtherTok{NA}\NormalTok{,}
                                                   \KeywordTok{ifelse}\NormalTok{(year}\OperatorTok{<}\DecValTok{1997}\OperatorTok{|}\NormalTok{year}\OperatorTok{>}\DecValTok{2015}\NormalTok{,n_fl}\OperatorTok{-}\NormalTok{grazing_success,}
                                                          \KeywordTok{ifelse}\NormalTok{(year}\OperatorTok{>}\DecValTok{2006}\OperatorTok{&}\NormalTok{year}\OperatorTok{<}\DecValTok{2016}\NormalTok{,}
\NormalTok{                                                                 shoot_vol}\OperatorTok{-}\NormalTok{grazing_success,}
                                                                 \DecValTok{999}\NormalTok{)))))}
\NormalTok{grazing_success_}\DecValTok{2006}\NormalTok{<-}\KeywordTok{read.table}\NormalTok{(}
  \StringTok{"C:/Users/user/Dropbox/SU/Projects/lathyrus/lathyrus_ms3/data/grazing_success_2006.csv"}\NormalTok{,}
  \DataTypeTok{header=}\NormalTok{T,}\DataTypeTok{sep=}\StringTok{","}\NormalTok{,}\DataTypeTok{dec=}\StringTok{"."}\NormalTok{)}
\NormalTok{data_selag<-data_selag}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{left_join}\NormalTok{(grazing_success_}\DecValTok{2006}\NormalTok{)}
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{grazing_success<-}\KeywordTok{with}\NormalTok{(data_selag,}\KeywordTok{ifelse}\NormalTok{(year}\OperatorTok{==}\DecValTok{2006}\NormalTok{,gr_success,grazing_success))}
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{grazing_failure<-}\KeywordTok{with}\NormalTok{(data_selag,}\KeywordTok{ifelse}\NormalTok{(year}\OperatorTok{==}\DecValTok{2006}\NormalTok{,gr_failure,grazing_failure))}
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{gr_success<-}\OtherTok{NULL}
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{gr_failure<-}\OtherTok{NULL}
\end{Highlighting}
\end{Shaded}

\hypertarget{raw-relationships-interactions-ffd-in-different-years}{%
\section{1. Raw relationships interactions \textasciitilde{} FFD in
different
years}\label{raw-relationships-interactions-ffd-in-different-years}}

\hypertarget{grazing}{%
\subsection{Grazing}\label{grazing}}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-3-1.pdf}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-4-1.pdf}
\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-4-2.pdf}

\hypertarget{number-of-seeds-per-flower}{%
\subsection{Number of seeds per
flower}\label{number-of-seeds-per-flower}}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-5-1.pdf}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-6-1.pdf}
\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-6-2.pdf}

\hypertarget{predation}{%
\subsection{Predation}\label{predation}}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-7-1.pdf}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-8-1.pdf}
\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-8-2.pdf}

\hypertarget{models-for-each-interaction}{%
\section{2. Models for each
interaction}\label{models-for-each-interaction}}

Including the effects of FFD standardized within years (FFD\_s\_y),
yearly mean of FFD (FFD\_mean), yearly standard deviation of FFD
(FFD\_sd), and the interactions FFD\_s\_y:FFD\_mean andn
FFD\_s\_y:FFD\_sd.

Calculate FFD\_s\_y, FFD\_mean and FFD\_sd:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data_selag<-data_selag}\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{group_by}\NormalTok{(year) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{FFD_mean=}\KeywordTok{mean}\NormalTok{(FFD,}\DataTypeTok{na.rm=}\NormalTok{T),}
         \DataTypeTok{FFD_sd=}\KeywordTok{sd}\NormalTok{(FFD,}\DataTypeTok{na.rm=}\NormalTok{T),}
         \DataTypeTok{FFD_s_y=}\NormalTok{(FFD}\OperatorTok{-}\NormalTok{FFD_mean)}\OperatorTok{/}\NormalTok{FFD_sd)}
\end{Highlighting}
\end{Shaded}

\hypertarget{grazing-1}{%
\subsection{Grazing}\label{grazing-1}}

\hypertarget{global-models}{%
\subsubsection{Global models}\label{global-models}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data_selag_subset1<-}\KeywordTok{subset}\NormalTok{(data_selag,}\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(grazing_success)}\OperatorTok{&!}\KeywordTok{is.na}\NormalTok{(FFD)}\OperatorTok{&!}\KeywordTok{is.na}\NormalTok{(n_fl))}
\NormalTok{globmod_grazing_A<-}\KeywordTok{glmer}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(grazing_success,grazing_failure)}\OperatorTok{~}
\StringTok{                           }\NormalTok{(}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{3}\NormalTok{)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{4}\NormalTok{)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{5}\NormalTok{))}\OperatorTok{*}\NormalTok{FFD_s_y}\OperatorTok{+}
\StringTok{                           }\KeywordTok{scale}\NormalTok{(n_fl)}\OperatorTok{+}\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id),}
                         \DataTypeTok{data =}\NormalTok{ data_selag_subset1,}\DataTypeTok{family=}\StringTok{"binomial"}\NormalTok{,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\NormalTok{globmod_grazing_B<-}\KeywordTok{glmer}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(grazing_success,grazing_failure)}\OperatorTok{~}
\StringTok{                           }\KeywordTok{scale}\NormalTok{(n_fl)}\OperatorTok{+}\NormalTok{FFD_s_y}\OperatorTok{*}\NormalTok{(}\KeywordTok{scale}\NormalTok{(FFD_mean)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(FFD_sd))}\OperatorTok{+}\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id),}
                         \DataTypeTok{data =}\NormalTok{ data_selag_subset1,}\DataTypeTok{family=}\StringTok{"binomial"}\NormalTok{,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\CommentTok{# Summary: failed to converge}
\KeywordTok{overdisp_fun}\NormalTok{(globmod_grazing_A)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        chisq        ratio          rdf            p 
## 1770292.5523     755.2443    2344.0000       0.0000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{overdisp_fun}\NormalTok{(globmod_grazing_B)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        chisq        ratio          rdf            p 
## 1355204.8916     577.6662    2346.0000       0.0000
\end{verbatim}

Significant overdispersion

\hypertarget{rerun-with-beta-binomial-distribution-in-glmmtmb}{%
\subsubsection{Rerun with beta binomial distribution in
glmmTMB}\label{rerun-with-beta-binomial-distribution-in-glmmtmb}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data_selag_subset1}\OperatorTok{$}\NormalTok{id_factor<-}\KeywordTok{as.factor}\NormalTok{(data_selag_subset1}\OperatorTok{$}\NormalTok{id)}
\NormalTok{globmod_grazing1_A<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(grazing_success,grazing_failure)}\OperatorTok{~}
\StringTok{                            }\NormalTok{(}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{3}\NormalTok{)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{4}\NormalTok{)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{5}\NormalTok{))}\OperatorTok{*}\NormalTok{FFD_s_y}\OperatorTok{+}
\StringTok{                           }\KeywordTok{scale}\NormalTok{(n_fl)}\OperatorTok{+}\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id_factor),}
                          \DataTypeTok{data=}\NormalTok{data_selag_subset1,}\DataTypeTok{family=}\NormalTok{betabinomial,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\NormalTok{globmod_grazing1_B<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(grazing_success,grazing_failure)}\OperatorTok{~}
\StringTok{                            }\KeywordTok{scale}\NormalTok{(n_fl)}\OperatorTok{+}\NormalTok{FFD_s_y}\OperatorTok{*}\NormalTok{(}\KeywordTok{scale}\NormalTok{(FFD_mean)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(FFD_sd))}\OperatorTok{+}\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id_factor),}
                          \DataTypeTok{data=}\NormalTok{data_selag_subset1,}\DataTypeTok{family=}\NormalTok{betabinomial,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(globmod_grazing1_A)}\OperatorTok{$}\NormalTok{coefficients,}\DataTypeTok{digits=}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{table}

\centering
\begin{tabular}[t]{l|r|r|r|r}
\hline
  & Estimate & Std. Error & z value & Pr(>|z|)\\
\hline
(Intercept) & -2.350 & 0.094 & -25.05 & 0.000\\
\hline
scale(mean\_3) & 0.579 & 0.077 & 7.53 & 0.000\\
\hline
scale(mean\_4) & -0.382 & 0.072 & -5.32 & 0.000\\
\hline
scale(mean\_5) & -0.364 & 0.071 & -5.14 & 0.000\\
\hline
FFD\_s\_y & -0.312 & 0.073 & -4.25 & 0.000\\
\hline
scale(n\_fl) & 0.100 & 0.052 & 1.95 & 0.052\\
\hline
scale(mean\_3):FFD\_s\_y & 0.115 & 0.082 & 1.40 & 0.162\\
\hline
scale(mean\_4):FFD\_s\_y & -0.132 & 0.074 & -1.78 & 0.075\\
\hline
scale(mean\_5):FFD\_s\_y & 0.026 & 0.073 & 0.35 & 0.724\\
\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(globmod_grazing1_B)}\OperatorTok{$}\NormalTok{coefficients,}\DataTypeTok{digits=}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{table}

\centering
\begin{tabular}[t]{l|r|r|r|r}
\hline
  & Estimate & Std. Error & z value & Pr(>|z|)\\
\hline
(Intercept) & -2.218 & 0.083 & -26.70 & 0.000\\
\hline
scale(n\_fl) & 0.094 & 0.049 & 1.92 & 0.055\\
\hline
FFD\_s\_y & -0.291 & 0.067 & -4.33 & 0.000\\
\hline
scale(FFD\_mean) & -0.013 & 0.065 & -0.20 & 0.839\\
\hline
scale(FFD\_sd) & -0.095 & 0.059 & -1.62 & 0.106\\
\hline
FFD\_s\_y:scale(FFD\_mean) & -0.091 & 0.065 & -1.39 & 0.163\\
\hline
FFD\_s\_y:scale(FFD\_sd) & -0.069 & 0.060 & -1.14 & 0.254\\
\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\end{table}

\hypertarget{collinearity}{%
\paragraph{Collinearity}\label{collinearity}}

Check for collinearity with variance inflation factors:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{check_collinearity}\NormalTok{(globmod_grazing1_A) }\CommentTok{# OK, all below 2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # Check for Multicollinearity
## 
## Low Correlation
## 
##              Parameter  VIF Increased SE
##          scale(mean_3) 1.54         1.24
##          scale(mean_4) 1.33         1.15
##          scale(mean_5) 1.32         1.15
##                FFD_s_y 1.29         1.13
##            scale(n_fl) 1.18         1.08
##  scale(mean_3):FFD_s_y 1.63         1.28
##  scale(mean_4):FFD_s_y 1.32         1.15
##  scale(mean_5):FFD_s_y 1.30         1.14
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{check_collinearity}\NormalTok{(globmod_grazing1_B) }\CommentTok{# OK, all below 2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # Check for Multicollinearity
## 
## Low Correlation
## 
##                Parameter  VIF Increased SE
##              scale(n_fl) 1.23         1.11
##                  FFD_s_y 1.15         1.07
##          scale(FFD_mean) 1.17         1.08
##            scale(FFD_sd) 1.10         1.05
##  FFD_s_y:scale(FFD_mean) 1.18         1.09
##    FFD_s_y:scale(FFD_sd) 1.10         1.05
\end{verbatim}

\hypertarget{model-diagnostics-with-dharma}{%
\paragraph{Model diagnostics with
DHARMa}\label{model-diagnostics-with-dharma}}

From:
\url{https://cran.r-project.org/web/packages/DHARMa/vignettes/DHARMa.html}

The `DHARMa' package uses a simulation-based approach to create readily
interpretable scaled (quantile) residuals for fitted (generalized)
linear mixed models.

The `DHARMa' package creates readily interpretable residuals for
generalized linear (mixed) models that are standardized to values
between 0 and 1, and that can be interpreted as intuitively as residuals
for the linear model. This is achieved by a simulation-based approach,
similar to the Bayesian p-value or the parametric bootstrap, that
transforms the residuals to a standardized scale. The basic steps are:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Simulate new data from the fitted model for each observation.
\item
  each observation, calculate the empirical cumulative density function
  for the simulated observations, which describes the possible values
  (and their probability) at the predictor combination of the observed
  value, assuming the fitted model is correct.
\item
  The residual is then defined as the value of the empirical density
  function at the value of the observed data, so a residual of 0 means
  that all simulated values are larger than the observed value, and a
  residual of 0.5 means half of the simulated values are larger than the
  observed value.
\end{enumerate}

The key advantage of this definition is that the so-defined residuals
always have the same, known distribution, independent of the model that
is fit, if the model is correctly specified. To see this, note that, if
the observed data was created from the same data-generating process that
we simulate from, all values of the cumulative distribution should
appear with equal probability. That means we expect the distribution of
the residuals to be flat, regardless of the model structure (Poisson,
binomial, random effects and so on).

For a correctly specified model we would expect a uniform (flat)
distribution of the overall residuals, and uniformity in y direction if
we plot against any predictor.

Simulate residuals of the model:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{simulationOutput_globmod_grazing1_A <-}\StringTok{ }
\StringTok{  }\KeywordTok{simulateResiduals}\NormalTok{(}\DataTypeTok{fittedModel=}\NormalTok{globmod_grazing1_A,}\DataTypeTok{n=}\DecValTok{5000}\NormalTok{)}
\NormalTok{simulationOutput_globmod_grazing1_B <-}
\StringTok{  }\KeywordTok{simulateResiduals}\NormalTok{(}\DataTypeTok{fittedModel=}\NormalTok{globmod_grazing1_B,}\DataTypeTok{n=}\DecValTok{5000}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

qq-plot and plot of residuals vs.~predicted:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(simulationOutput_globmod_grazing1_A)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-14-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(simulationOutput_globmod_grazing1_B)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-14-2.pdf}

Test of dispersion is significant --\textgreater{} what does this mean?

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_grazing1_A)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-15-1.pdf}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.30307, p-value < 2.2e-16
## alternative hypothesis: two.sided
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_grazing1_A,}\DataTypeTok{alternative=}\StringTok{"greater"}\NormalTok{,}\DataTypeTok{plot=}\NormalTok{F) }\CommentTok{# Overdispersion}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.30307, p-value = 1
## alternative hypothesis: greater
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_grazing1_A,}\DataTypeTok{alternative=}\StringTok{"less"}\NormalTok{,}\DataTypeTok{plot=}\NormalTok{F) }\CommentTok{# Underdispersion}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.30307, p-value < 2.2e-16
## alternative hypothesis: less
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_grazing1_B)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-15-2.pdf}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.28881, p-value < 2.2e-16
## alternative hypothesis: two.sided
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_grazing1_B,}\DataTypeTok{alternative=}\StringTok{"greater"}\NormalTok{,}\DataTypeTok{plot=}\NormalTok{F) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.28881, p-value = 1
## alternative hypothesis: greater
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_grazing1_B,}\DataTypeTok{alternative=}\StringTok{"less"}\NormalTok{,}\DataTypeTok{plot=}\NormalTok{F) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.28881, p-value < 2.2e-16
## alternative hypothesis: less
\end{verbatim}

The test shows that there is underdispersion. However, according to
\url{https://stats.stackexchange.com/questions/396336/r-glmm-for-unbalanced-zero-inflated-data-glmmtmb},
when fitting GLMMs with variable dispersion, zero-inflation often shows
up as underdispersion, so the most reliable test is usually to run a
model selection with ZIP against standard model.

Zero inflation test is not significant:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testZeroInflation}\NormalTok{(simulationOutput_globmod_grazing1_A)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-16-1.pdf}

\begin{verbatim}
## 
##  DHARMa zero-inflation test via comparison to expected zeros with
##  simulation under H0 = fitted model
## 
## data:  simulationOutput
## ratioObsSim = 0.99837, p-value = 0.8724
## alternative hypothesis: two.sided
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testZeroInflation}\NormalTok{(simulationOutput_globmod_grazing1_B)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-16-2.pdf}

\begin{verbatim}
## 
##  DHARMa zero-inflation test via comparison to expected zeros with
##  simulation under H0 = fitted model
## 
## data:  simulationOutput
## ratioObsSim = 0.99902, p-value = 0.9228
## alternative hypothesis: two.sided
\end{verbatim}

Plot the residuals against other predictors:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_grazing1_A, }\KeywordTok{scale}\NormalTok{(data_selag_subset1}\OperatorTok{$}\NormalTok{mean_}\DecValTok{3}\NormalTok{))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_grazing1_A, }\KeywordTok{scale}\NormalTok{(data_selag_subset1}\OperatorTok{$}\NormalTok{mean_}\DecValTok{4}\NormalTok{))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_grazing1_A, }\KeywordTok{scale}\NormalTok{(data_selag_subset1}\OperatorTok{$}\NormalTok{mean_}\DecValTok{5}\NormalTok{))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_grazing1_A, }\KeywordTok{scale}\NormalTok{(data_selag_subset1}\OperatorTok{$}\NormalTok{n_fl))}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-17-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_grazing1_A, }\KeywordTok{scale}\NormalTok{(data_selag_subset1}\OperatorTok{$}\NormalTok{FFD_s_y))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_grazing1_B, }\KeywordTok{scale}\NormalTok{(data_selag_subset1}\OperatorTok{$}\NormalTok{n_fl))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_grazing1_B, }\KeywordTok{scale}\NormalTok{(data_selag_subset1}\OperatorTok{$}\NormalTok{FFD_s_y))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_grazing1_B, }\KeywordTok{scale}\NormalTok{(data_selag_subset1}\OperatorTok{$}\NormalTok{FFD_mean))}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-17-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_grazing1_B, }\KeywordTok{scale}\NormalTok{(data_selag_subset1}\OperatorTok{$}\NormalTok{FFD_sd))}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-17-3.pdf}

Histogram of the residuals:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{hist}\NormalTok{(simulationOutput_globmod_grazing1_A)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-18-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{hist}\NormalTok{(simulationOutput_globmod_grazing1_B)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-18-2.pdf}

Seems OK, with no outliers.

Goodness-of-fit tests on the simulated residuals:

testUniformity() - tests if the overall distribution conforms to
expectations testOutliers() - tests if there are more simulation
outliers than expected testDispersion() - tests if the simulated
dispersion is equal to the observed dispersion

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testResiduals}\NormalTok{(simulationOutput_globmod_grazing1_A)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-19-1.pdf}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.015149, p-value = 0.6525
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.30307, p-value < 2.2e-16
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 0.0000e+00, outHigh = 0.0000e+00, nobs = 2.3540e+03, freqH0 =
## 1.9996e-04, p-value = 1
## alternative hypothesis: two.sided
\end{verbatim}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.015149, p-value = 0.6525
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.30307, p-value < 2.2e-16
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 0.0000e+00, outHigh = 0.0000e+00, nobs = 2.3540e+03, freqH0 =
## 1.9996e-04, p-value = 1
## alternative hypothesis: two.sided
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testResiduals}\NormalTok{(simulationOutput_globmod_grazing1_B)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-19-2.pdf}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.015137, p-value = 0.6534
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.28881, p-value < 2.2e-16
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 0.0000e+00, outHigh = 0.0000e+00, nobs = 2.3540e+03, freqH0 =
## 1.9996e-04, p-value = 1
## alternative hypothesis: two.sided
\end{verbatim}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.015137, p-value = 0.6534
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.28881, p-value < 2.2e-16
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 0.0000e+00, outHigh = 0.0000e+00, nobs = 2.3540e+03, freqH0 =
## 1.9996e-04, p-value = 1
## alternative hypothesis: two.sided
\end{verbatim}

The simulated dispersion is not equal to the observed dispersion.

Using glmmTMB, we cannot perform model selection using dredge or use
piecewiseSEM.

\hypertarget{proportion-of-predated-seeds}{%
\subsection{Proportion of predated
seeds}\label{proportion-of-predated-seeds}}

\hypertarget{global-models-1}{%
\subsubsection{Global models}\label{global-models-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data_selag_subset2<-}\KeywordTok{subset}\NormalTok{(}\KeywordTok{subset}\NormalTok{(data_selag,n_seeds}\OperatorTok{>}\DecValTok{0}\NormalTok{),}\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(n_intact_seeds)}\OperatorTok{&}
\StringTok{                             }\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(n_fl)}\OperatorTok{&!}\KeywordTok{is.na}\NormalTok{(FFD))}
\NormalTok{globmod_pred_GLM_A<-}\KeywordTok{glm}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(}\KeywordTok{round}\NormalTok{(n_pred_seeds),}\KeywordTok{round}\NormalTok{(n_intact_seeds))}\OperatorTok{~}
\StringTok{                        }\NormalTok{(}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{3}\NormalTok{)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{4}\NormalTok{)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{5}\NormalTok{)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{6}\NormalTok{))}\OperatorTok{*}\NormalTok{FFD_s_y}\OperatorTok{+}
\StringTok{                          }\KeywordTok{scale}\NormalTok{(n_fl),}\DataTypeTok{data =}\NormalTok{ data_selag_subset2,}\DataTypeTok{family=}\StringTok{"binomial"}\NormalTok{,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\NormalTok{globmod_pred_GLM_B<-}\KeywordTok{glm}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(}\KeywordTok{round}\NormalTok{(n_pred_seeds),}\KeywordTok{round}\NormalTok{(n_intact_seeds))}\OperatorTok{~}
\StringTok{                        }\KeywordTok{scale}\NormalTok{(n_fl)}\OperatorTok{+}\NormalTok{FFD_s_y}\OperatorTok{*}\NormalTok{(}\KeywordTok{scale}\NormalTok{(FFD_mean)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(FFD_sd)),}
                         \DataTypeTok{data =}\NormalTok{ data_selag_subset2,}\DataTypeTok{family=}\StringTok{"binomial"}\NormalTok{,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\KeywordTok{overdisp_fun}\NormalTok{(globmod_pred_GLM_A)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       chisq       ratio         rdf           p 
## 8223.907918    6.475518 1270.000000    0.000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{overdisp_fun}\NormalTok{(globmod_pred_GLM_B)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       chisq       ratio         rdf           p 
## 8575.481658    6.731147 1274.000000    0.000000
\end{verbatim}

Significant overdispersion

\hypertarget{rerun-with-beta-binomial-distribution-in-glmmtbm}{%
\subsubsection{Rerun with beta binomial distribution in
glmmTBM}\label{rerun-with-beta-binomial-distribution-in-glmmtbm}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{globmod_pred_GLM1_A<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(}\KeywordTok{round}\NormalTok{(n_pred_seeds),}\KeywordTok{round}\NormalTok{(n_intact_seeds))}\OperatorTok{~}
\StringTok{                             }\NormalTok{(}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{3}\NormalTok{)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{4}\NormalTok{)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{5}\NormalTok{)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{6}\NormalTok{))}\OperatorTok{*}\NormalTok{FFD_s_y}\OperatorTok{+}
\StringTok{                          }\KeywordTok{scale}\NormalTok{(n_fl),}
                          \DataTypeTok{data=}\NormalTok{data_selag_subset2,}\DataTypeTok{family=}\NormalTok{betabinomial,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\NormalTok{globmod_pred_GLM1_B<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(}\KeywordTok{round}\NormalTok{(n_pred_seeds),}\KeywordTok{round}\NormalTok{(n_intact_seeds))}\OperatorTok{~}
\StringTok{                             }\KeywordTok{scale}\NormalTok{(n_fl)}\OperatorTok{+}\NormalTok{FFD_s_y}\OperatorTok{*}\NormalTok{(}\KeywordTok{scale}\NormalTok{(FFD_mean)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(FFD_sd)),}
                           \DataTypeTok{data=}\NormalTok{data_selag_subset2,}\DataTypeTok{family=}\NormalTok{betabinomial,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(globmod_pred_GLM1_A)}\OperatorTok{$}\NormalTok{coefficients,}\DataTypeTok{digits=}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{table}

\centering
\begin{tabular}[t]{l|r|r|r|r}
\hline
  & Estimate & Std. Error & z value & Pr(>|z|)\\
\hline
(Intercept) & -0.784 & 0.049 & -15.89 & 0.000\\
\hline
scale(mean\_3) & -0.201 & 0.071 & -2.83 & 0.005\\
\hline
scale(mean\_4) & 0.033 & 0.059 & 0.56 & 0.579\\
\hline
scale(mean\_5) & 0.475 & 0.072 & 6.61 & 0.000\\
\hline
scale(mean\_6) & 0.397 & 0.061 & 6.46 & 0.000\\
\hline
FFD\_s\_y & -0.008 & 0.056 & -0.14 & 0.888\\
\hline
scale(n\_fl) & 0.136 & 0.047 & 2.88 & 0.004\\
\hline
scale(mean\_3):FFD\_s\_y & 0.151 & 0.079 & 1.90 & 0.057\\
\hline
scale(mean\_4):FFD\_s\_y & -0.141 & 0.065 & -2.15 & 0.032\\
\hline
scale(mean\_5):FFD\_s\_y & 0.033 & 0.077 & 0.43 & 0.665\\
\hline
scale(mean\_6):FFD\_s\_y & -0.085 & 0.067 & -1.26 & 0.207\\
\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(globmod_pred_GLM1_B)}\OperatorTok{$}\NormalTok{coefficients,}\DataTypeTok{digits=}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{table}

\centering
\begin{tabular}[t]{l|r|r|r|r}
\hline
  & Estimate & Std. Error & z value & Pr(>|z|)\\
\hline
(Intercept) & -0.788 & 0.050 & -15.92 & 0.000\\
\hline
scale(n\_fl) & 0.174 & 0.046 & 3.76 & 0.000\\
\hline
FFD\_s\_y & -0.008 & 0.056 & -0.14 & 0.886\\
\hline
scale(FFD\_mean) & -0.531 & 0.053 & -10.04 & 0.000\\
\hline
scale(FFD\_sd) & -0.653 & 0.051 & -12.76 & 0.000\\
\hline
FFD\_s\_y:scale(FFD\_mean) & -0.080 & 0.057 & -1.40 & 0.160\\
\hline
FFD\_s\_y:scale(FFD\_sd) & -0.046 & 0.055 & -0.84 & 0.403\\
\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\end{table}

\hypertarget{collinearity-1}{%
\paragraph{Collinearity}\label{collinearity-1}}

Check for collinearity with variance inflation factors:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{check_collinearity}\NormalTok{(globmod_pred_GLM1_A) }\CommentTok{# OK, all below 2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # Check for Multicollinearity
## 
## Low Correlation
## 
##              Parameter  VIF Increased SE
##          scale(mean_3) 2.59         1.61
##          scale(mean_4) 2.00         1.41
##          scale(mean_5) 2.39         1.55
##          scale(mean_6) 1.71         1.31
##                FFD_s_y 1.20         1.09
##            scale(n_fl) 1.16         1.08
##  scale(mean_3):FFD_s_y 2.56         1.60
##  scale(mean_4):FFD_s_y 1.98         1.41
##  scale(mean_5):FFD_s_y 2.35         1.53
##  scale(mean_6):FFD_s_y 1.68         1.29
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{check_collinearity}\NormalTok{(globmod_pred_GLM1_B) }\CommentTok{# OK, all below 2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # Check for Multicollinearity
## 
## Low Correlation
## 
##                Parameter  VIF Increased SE
##              scale(n_fl) 1.19         1.09
##                  FFD_s_y 1.18         1.08
##          scale(FFD_mean) 1.24         1.11
##            scale(FFD_sd) 1.23         1.11
##  FFD_s_y:scale(FFD_mean) 1.26         1.12
##    FFD_s_y:scale(FFD_sd) 1.22         1.11
\end{verbatim}

\hypertarget{model-diagnostics-with-dharma-1}{%
\paragraph{Model diagnostics with
DHARMa}\label{model-diagnostics-with-dharma-1}}

Simulate residuals of the model:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{simulationOutput_globmod_pred_GLM1_A <-}\StringTok{ }
\StringTok{  }\KeywordTok{simulateResiduals}\NormalTok{(}\DataTypeTok{fittedModel =}\NormalTok{ globmod_pred_GLM1_A, }\DataTypeTok{n =} \DecValTok{5000}\NormalTok{)}
\NormalTok{simulationOutput_globmod_pred_GLM1_B <-}\StringTok{ }
\StringTok{  }\KeywordTok{simulateResiduals}\NormalTok{(}\DataTypeTok{fittedModel =}\NormalTok{ globmod_pred_GLM1_B, }\DataTypeTok{n =} \DecValTok{5000}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

qq-plot and plot of residuals vs.~predicted:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(simulationOutput_globmod_pred_GLM1_A)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-24-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(simulationOutput_globmod_pred_GLM1_B)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-24-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Both are good!}
\end{Highlighting}
\end{Shaded}

There seems to be heteroscedasticity. According to
\url{https://cran.r-project.org/web/packages/DHARMa/vignettes/DHARMa.html},
this means that there is a systematic dependency of the dispersion /
variance on another variable in the model. It is not sufficiently
appreciated that also binomial or Poisson models can show
heteroscedasticity. Basically, it means that the level of
over/underdispersion depends on another parameter.

Maybe we can live with this?

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_pred_GLM1_A)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-25-1.pdf}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.84877, p-value = 0.002
## alternative hypothesis: two.sided
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_pred_GLM1_A,}\DataTypeTok{alternative=}\StringTok{"greater"}\NormalTok{,}
               \DataTypeTok{plot=}\NormalTok{F) }\CommentTok{# Overdispersion}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.84877, p-value = 0.999
## alternative hypothesis: greater
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_pred_GLM1_A,}\DataTypeTok{alternative=}\StringTok{"less"}\NormalTok{,}
               \DataTypeTok{plot=}\NormalTok{F) }\CommentTok{# Underdispersion}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.84877, p-value = 0.001
## alternative hypothesis: less
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_pred_GLM1_B)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-25-2.pdf}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.87723, p-value = 0.0116
## alternative hypothesis: two.sided
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_pred_GLM1_B,}\DataTypeTok{alternative=}\StringTok{"greater"}\NormalTok{,}
               \DataTypeTok{plot=}\NormalTok{F) }\CommentTok{# Overdispersion}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.87723, p-value = 0.9942
## alternative hypothesis: greater
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_pred_GLM1_B,}\DataTypeTok{alternative=}\StringTok{"less"}\NormalTok{,}
               \DataTypeTok{plot=}\NormalTok{F) }\CommentTok{# Underdispersion}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.87723, p-value = 0.0058
## alternative hypothesis: less
\end{verbatim}

Zero inflation test is significant:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testZeroInflation}\NormalTok{(simulationOutput_globmod_pred_GLM1_A)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-26-1.pdf}

\begin{verbatim}
## 
##  DHARMa zero-inflation test via comparison to expected zeros with
##  simulation under H0 = fitted model
## 
## data:  simulationOutput
## ratioObsSim = 1.035, p-value = 0.2904
## alternative hypothesis: two.sided
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testZeroInflation}\NormalTok{(simulationOutput_globmod_pred_GLM1_B)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-26-2.pdf}

\begin{verbatim}
## 
##  DHARMa zero-inflation test via comparison to expected zeros with
##  simulation under H0 = fitted model
## 
## data:  simulationOutput
## ratioObsSim = 1.0327, p-value = 0.326
## alternative hypothesis: two.sided
\end{verbatim}

There is a slight zero-inflation.

Plot the residuals against other predictors:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_pred_GLM1_A, }\KeywordTok{scale}\NormalTok{(data_selag_subset2}\OperatorTok{$}\NormalTok{mean_}\DecValTok{3}\NormalTok{))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_pred_GLM1_A, }\KeywordTok{scale}\NormalTok{(data_selag_subset2}\OperatorTok{$}\NormalTok{mean_}\DecValTok{4}\NormalTok{))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_pred_GLM1_A, }\KeywordTok{scale}\NormalTok{(data_selag_subset2}\OperatorTok{$}\NormalTok{mean_}\DecValTok{5}\NormalTok{))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_pred_GLM1_A, }\KeywordTok{scale}\NormalTok{(data_selag_subset2}\OperatorTok{$}\NormalTok{mean_}\DecValTok{6}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-27-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_pred_GLM1_A, }\KeywordTok{scale}\NormalTok{(data_selag_subset2}\OperatorTok{$}\NormalTok{n_fl))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_pred_GLM1_A, }\KeywordTok{scale}\NormalTok{(data_selag_subset2}\OperatorTok{$}\NormalTok{FFD_s_y))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_pred_GLM1_B, }\KeywordTok{scale}\NormalTok{(data_selag_subset2}\OperatorTok{$}\NormalTok{n_fl))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_pred_GLM1_B, }\KeywordTok{scale}\NormalTok{(data_selag_subset2}\OperatorTok{$}\NormalTok{FFD_s_y))}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-27-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_pred_GLM1_B, }\KeywordTok{scale}\NormalTok{(data_selag_subset2}\OperatorTok{$}\NormalTok{FFD_mean))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_pred_GLM1_B, }\KeywordTok{scale}\NormalTok{(data_selag_subset2}\OperatorTok{$}\NormalTok{FFD_sd))}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-27-3.pdf}

Histogram of the residuals:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{hist}\NormalTok{(simulationOutput_globmod_pred_GLM1_A)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-28-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{hist}\NormalTok{(simulationOutput_globmod_pred_GLM1_B)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-28-2.pdf}

Seems OK, with no outliers.

Goodness-of-fit tests on the simulated residuals:

testUniformity() - tests if the overall distribution conforms to
expectations testOutliers() - tests if there are more simulation
outliers than expected testDispersion() - tests if the simulated
dispersion is equal to the observed dispersion

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testResiduals}\NormalTok{(simulationOutput_globmod_pred_GLM1_A)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-29-1.pdf}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.02546, p-value = 0.3774
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.84877, p-value = 0.002
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 0.0000e+00, outHigh = 0.0000e+00, nobs = 1.2810e+03, freqH0 =
## 1.9996e-04, p-value = 1
## alternative hypothesis: two.sided
\end{verbatim}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.02546, p-value = 0.3774
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.84877, p-value = 0.002
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 0.0000e+00, outHigh = 0.0000e+00, nobs = 1.2810e+03, freqH0 =
## 1.9996e-04, p-value = 1
## alternative hypothesis: two.sided
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testResiduals}\NormalTok{(simulationOutput_globmod_pred_GLM1_B)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-29-2.pdf}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.028571, p-value = 0.2466
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.87723, p-value = 0.0116
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 0.0000e+00, outHigh = 0.0000e+00, nobs = 1.2810e+03, freqH0 =
## 1.9996e-04, p-value = 1
## alternative hypothesis: two.sided
\end{verbatim}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.028571, p-value = 0.2466
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.87723, p-value = 0.0116
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 0.0000e+00, outHigh = 0.0000e+00, nobs = 1.2810e+03, freqH0 =
## 1.9996e-04, p-value = 1
## alternative hypothesis: two.sided
\end{verbatim}

They seem OK.

\hypertarget{number-of-seeds-per-flower-1}{%
\subsection{Number of seeds per
flower}\label{number-of-seeds-per-flower-1}}

\hypertarget{global-model}{%
\subsubsection{Global model}\label{global-model}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data_selag_subset3<-}\KeywordTok{subset}\NormalTok{(data_selag,}\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(n_seeds_per_fl)}\OperatorTok{&!}\KeywordTok{is.na}\NormalTok{(FFD))}
\NormalTok{globmod_seedsperfl_A<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{round}\NormalTok{(n_seeds_per_fl)}\OperatorTok{~}
\StringTok{                                }\NormalTok{(}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{3}\NormalTok{)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{4}\NormalTok{)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(mean_}\DecValTok{5}\NormalTok{))}\OperatorTok{*}\NormalTok{FFD_s_y}\OperatorTok{+}
\StringTok{                                }\KeywordTok{scale}\NormalTok{(n_fl)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(grazing_corr)}\OperatorTok{+}\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id),}
                              \DataTypeTok{data =}\NormalTok{ data_selag_subset3,}\DataTypeTok{family=}\StringTok{"poisson"}\NormalTok{,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\NormalTok{globmod_seedsperfl_B<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{round}\NormalTok{(n_seeds_per_fl)}\OperatorTok{~}
\StringTok{                              }\KeywordTok{scale}\NormalTok{(n_fl)}\OperatorTok{+}\NormalTok{FFD_s_y}\OperatorTok{*}\NormalTok{(}\KeywordTok{scale}\NormalTok{(FFD_mean)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(FFD_sd))}\OperatorTok{+}
\StringTok{                              }\KeywordTok{scale}\NormalTok{(grazing_corr)}\OperatorTok{+}\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id),}
                         \DataTypeTok{data =}\NormalTok{ data_selag_subset3,}\DataTypeTok{family=}\StringTok{"poisson"}\NormalTok{,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\KeywordTok{overdisp_fun}\NormalTok{(globmod_seedsperfl_A) }\CommentTok{# No overdispersion}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        chisq        ratio          rdf            p 
## 2155.4700706    0.9114038 2365.0000000    0.9991312
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{overdisp_fun}\NormalTok{(globmod_seedsperfl_B) }\CommentTok{# No overdispersion}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        chisq        ratio          rdf            p 
## 2125.4044816    0.8979318 2367.0000000    0.9998576
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(globmod_seedsperfl_A)}\OperatorTok{$}\NormalTok{coefficients,}\DataTypeTok{digits=}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{table}

\centering
\begin{tabular}[t]{l|r|r|r|r}
\hline
  & Estimate & Std. Error & z value & Pr(>|z|)\\
\hline
(Intercept) & -0.763 & 0.046 & -16.55 & 0.000\\
\hline
scale(mean\_3) & 0.006 & 0.035 & 0.18 & 0.858\\
\hline
scale(mean\_4) & 0.007 & 0.032 & 0.20 & 0.838\\
\hline
scale(mean\_5) & -0.062 & 0.030 & -2.06 & 0.039\\
\hline
FFD\_s\_y & -0.250 & 0.032 & -7.72 & 0.000\\
\hline
scale(n\_fl) & -0.283 & 0.046 & -6.18 & 0.000\\
\hline
scale(grazing\_corr) & -0.676 & 0.064 & -10.59 & 0.000\\
\hline
scale(mean\_3):FFD\_s\_y & 0.018 & 0.037 & 0.48 & 0.631\\
\hline
scale(mean\_4):FFD\_s\_y & -0.022 & 0.033 & -0.66 & 0.511\\
\hline
scale(mean\_5):FFD\_s\_y & 0.037 & 0.032 & 1.16 & 0.244\\
\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(globmod_seedsperfl_B)}\OperatorTok{$}\NormalTok{coefficients,}\DataTypeTok{digits=}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{table}

\centering
\begin{tabular}[t]{l|r|r|r|r}
\hline
  & Estimate & Std. Error & z value & Pr(>|z|)\\
\hline
(Intercept) & -0.758 & 0.046 & -16.63 & 0.000\\
\hline
scale(n\_fl) & -0.287 & 0.046 & -6.28 & 0.000\\
\hline
FFD\_s\_y & -0.257 & 0.033 & -7.87 & 0.000\\
\hline
scale(FFD\_mean) & -0.036 & 0.029 & -1.25 & 0.211\\
\hline
scale(FFD\_sd) & 0.143 & 0.026 & 5.44 & 0.000\\
\hline
scale(grazing\_corr) & -0.670 & 0.064 & -10.43 & 0.000\\
\hline
FFD\_s\_y:scale(FFD\_mean) & -0.032 & 0.028 & -1.12 & 0.262\\
\hline
FFD\_s\_y:scale(FFD\_sd) & -0.004 & 0.028 & -0.13 & 0.899\\
\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\end{table}

\hypertarget{collinearity-2}{%
\paragraph{Collinearity}\label{collinearity-2}}

Check for collinearity with variance inflation factors:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{check_collinearity}\NormalTok{(globmod_seedsperfl_A) }\CommentTok{# OK, all below 2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # Check for Multicollinearity
## 
## Low Correlation
## 
##              Parameter  VIF Increased SE
##          scale(mean_3) 1.66         1.29
##          scale(mean_4) 1.38         1.17
##          scale(mean_5) 1.32         1.15
##                FFD_s_y 1.20         1.10
##            scale(n_fl) 1.20         1.10
##    scale(grazing_corr) 1.01         1.01
##  scale(mean_3):FFD_s_y 1.60         1.27
##  scale(mean_4):FFD_s_y 1.33         1.15
##  scale(mean_5):FFD_s_y 1.29         1.14
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{check_collinearity}\NormalTok{(globmod_seedsperfl_B) }\CommentTok{# OK, all below 2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # Check for Multicollinearity
## 
## Low Correlation
## 
##                Parameter  VIF Increased SE
##              scale(n_fl) 1.23         1.11
##                  FFD_s_y 1.22         1.10
##          scale(FFD_mean) 1.04         1.02
##            scale(FFD_sd) 1.03         1.01
##      scale(grazing_corr) 1.01         1.00
##  FFD_s_y:scale(FFD_mean) 1.04         1.02
##    FFD_s_y:scale(FFD_sd) 1.05         1.02
\end{verbatim}

\hypertarget{model-diagnostics-with-dharma-2}{%
\paragraph{Model diagnostics with
DHARMa}\label{model-diagnostics-with-dharma-2}}

Simulate residuals of the model:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{simulationOutput_globmod_seedsperfl_A <-}\StringTok{ }
\StringTok{  }\KeywordTok{simulateResiduals}\NormalTok{(}\DataTypeTok{fittedModel =}\NormalTok{ globmod_seedsperfl_A, }\DataTypeTok{n =} \DecValTok{5000}\NormalTok{)}
\NormalTok{simulationOutput_globmod_seedsperfl_B <-}\StringTok{ }
\StringTok{  }\KeywordTok{simulateResiduals}\NormalTok{(}\DataTypeTok{fittedModel =}\NormalTok{ globmod_seedsperfl_B, }\DataTypeTok{n =} \DecValTok{5000}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

qq-plot and plot of residuals vs.~predicted:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(simulationOutput_globmod_seedsperfl_A) }\CommentTok{# Good!}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-33-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(simulationOutput_globmod_seedsperfl_B) }\CommentTok{# Good!}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-33-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_seedsperfl_A)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-34-1.pdf}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 1.0616, p-value = 0.1024
## alternative hypothesis: two.sided
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_seedsperfl_A,}\DataTypeTok{alternative=}\StringTok{"greater"}\NormalTok{,}
               \DataTypeTok{plot=}\NormalTok{F) }\CommentTok{# Overdispersion}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 1.0616, p-value = 0.0512
## alternative hypothesis: greater
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_seedsperfl_A,}\DataTypeTok{alternative=}\StringTok{"less"}\NormalTok{,}
               \DataTypeTok{plot=}\NormalTok{F) }\CommentTok{# Underdispersion}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 1.0616, p-value = 0.9488
## alternative hypothesis: less
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_seedsperfl_B)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-34-2.pdf}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 1.0522, p-value = 0.1572
## alternative hypothesis: two.sided
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_seedsperfl_B,}\DataTypeTok{alternative=}\StringTok{"greater"}\NormalTok{,}
               \DataTypeTok{plot=}\NormalTok{F) }\CommentTok{# Overdispersion}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 1.0522, p-value = 0.0786
## alternative hypothesis: greater
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_globmod_seedsperfl_B,}\DataTypeTok{alternative=}\StringTok{"less"}\NormalTok{,}
               \DataTypeTok{plot=}\NormalTok{F) }\CommentTok{# Underdispersion}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 1.0522, p-value = 0.9214
## alternative hypothesis: less
\end{verbatim}

Zero inflation test is not significant:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testZeroInflation}\NormalTok{(simulationOutput_globmod_seedsperfl_A)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-35-1.pdf}

\begin{verbatim}
## 
##  DHARMa zero-inflation test via comparison to expected zeros with
##  simulation under H0 = fitted model
## 
## data:  simulationOutput
## ratioObsSim = 1.0147, p-value = 0.4764
## alternative hypothesis: two.sided
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testZeroInflation}\NormalTok{(simulationOutput_globmod_seedsperfl_B)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-35-2.pdf}

\begin{verbatim}
## 
##  DHARMa zero-inflation test via comparison to expected zeros with
##  simulation under H0 = fitted model
## 
## data:  simulationOutput
## ratioObsSim = 1.0178, p-value = 0.378
## alternative hypothesis: two.sided
\end{verbatim}

Plot the residuals against other predictors:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_seedsperfl_A, }\KeywordTok{scale}\NormalTok{(data_selag_subset3}\OperatorTok{$}\NormalTok{mean_}\DecValTok{3}\NormalTok{))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_seedsperfl_A, }\KeywordTok{scale}\NormalTok{(data_selag_subset3}\OperatorTok{$}\NormalTok{mean_}\DecValTok{4}\NormalTok{))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_seedsperfl_A, }\KeywordTok{scale}\NormalTok{(data_selag_subset3}\OperatorTok{$}\NormalTok{mean_}\DecValTok{5}\NormalTok{))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_seedsperfl_A, }\KeywordTok{scale}\NormalTok{(data_selag_subset3}\OperatorTok{$}\NormalTok{n_fl))}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-36-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_seedsperfl_A, data_selag_subset3}\OperatorTok{$}\NormalTok{FFD_s_y)}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_seedsperfl_A,}
              \KeywordTok{scale}\NormalTok{(data_selag_subset3}\OperatorTok{$}\NormalTok{grazing_corr))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_seedsperfl_B, }\KeywordTok{scale}\NormalTok{(data_selag_subset3}\OperatorTok{$}\NormalTok{FFD_mean))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_seedsperfl_B, }\KeywordTok{scale}\NormalTok{(data_selag_subset3}\OperatorTok{$}\NormalTok{FFD_sd))}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-36-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_seedsperfl_B, }\KeywordTok{scale}\NormalTok{(data_selag_subset3}\OperatorTok{$}\NormalTok{n_fl))}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_seedsperfl_B, data_selag_subset3}\OperatorTok{$}\NormalTok{FFD_s_y)}
\KeywordTok{plotResiduals}\NormalTok{(simulationOutput_globmod_seedsperfl_B,}
              \KeywordTok{scale}\NormalTok{(data_selag_subset3}\OperatorTok{$}\NormalTok{grazing_corr))}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-36-3.pdf}

Histogram of the residuals:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{hist}\NormalTok{(simulationOutput_globmod_seedsperfl_A)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-37-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{hist}\NormalTok{(simulationOutput_globmod_seedsperfl_B)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-37-2.pdf}

Goodness-of-fit tests on the simulated residuals:

testUniformity() - tests if the overall distribution conforms to
expectations testOutliers() - tests if there are more simulation
outliers than expected testDispersion() - tests if the simulated
dispersion is equal to the observed dispersion

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testResiduals}\NormalTok{(simulationOutput_globmod_seedsperfl_A)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-38-1.pdf}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.027755, p-value = 0.05144
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 1.0616, p-value = 0.1024
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 0.0000e+00, outHigh = 2.0000e+00, nobs = 2.3760e+03, freqH0 =
## 1.9996e-04, p-value = 0.1655
## alternative hypothesis: two.sided
\end{verbatim}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.027755, p-value = 0.05144
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 1.0616, p-value = 0.1024
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 0.0000e+00, outHigh = 2.0000e+00, nobs = 2.3760e+03, freqH0 =
## 1.9996e-04, p-value = 0.1655
## alternative hypothesis: two.sided
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testResiduals}\NormalTok{(simulationOutput_globmod_seedsperfl_B)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-38-2.pdf}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.016775, p-value = 0.5157
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 1.0522, p-value = 0.1572
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 0.0000e+00, outHigh = 1.0000e+00, nobs = 2.3760e+03, freqH0 =
## 1.9996e-04, p-value = 0.7564
## alternative hypothesis: two.sided
\end{verbatim}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.016775, p-value = 0.5157
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 1.0522, p-value = 0.1572
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 0.0000e+00, outHigh = 1.0000e+00, nobs = 2.3760e+03, freqH0 =
## 1.9996e-04, p-value = 0.7564
## alternative hypothesis: two.sided
\end{verbatim}

\hypertarget{graphs}{%
\subsection{Graphs}\label{graphs}}

Fit models with all non-scaled variables, but keep FFD\_s\_y. When
FFD\_s\_y is significant, effects are taken from models with
temperatures (i.e.~``A'' models).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{globmod_grazing1_A_ns<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(grazing_success,grazing_failure)}\OperatorTok{~}\NormalTok{(mean_}\DecValTok{3}\OperatorTok{+}\NormalTok{mean_}\DecValTok{4}\OperatorTok{+}\NormalTok{mean_}\DecValTok{5}\NormalTok{)}\OperatorTok{*}\NormalTok{FFD_s_y}\OperatorTok{+}
\StringTok{                                 }\NormalTok{n_fl}\OperatorTok{+}\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id_factor),}\DataTypeTok{data=}\NormalTok{data_selag_subset1,}
                               \DataTypeTok{family=}\NormalTok{betabinomial,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\NormalTok{globmod_grazing1_B_ns<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(grazing_success,grazing_failure)}\OperatorTok{~}\NormalTok{n_fl}\OperatorTok{+}\NormalTok{FFD_s_y}\OperatorTok{*}\NormalTok{(FFD_mean}\OperatorTok{+}\NormalTok{FFD_sd)}\OperatorTok{+}
\StringTok{                              }\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id_factor),}\DataTypeTok{data=}\NormalTok{data_selag_subset1,}
                              \DataTypeTok{family=}\NormalTok{betabinomial,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\NormalTok{globmod_seedsperfl_A_ns<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{round}\NormalTok{(n_seeds_per_fl)}\OperatorTok{~}
\StringTok{                                }\NormalTok{(mean_}\DecValTok{3}\OperatorTok{+}\NormalTok{mean_}\DecValTok{4}\OperatorTok{+}\NormalTok{mean_}\DecValTok{5}\NormalTok{)}\OperatorTok{*}\NormalTok{FFD_s_y}\OperatorTok{+}\NormalTok{n_fl}\OperatorTok{+}\NormalTok{grazing_corr}\OperatorTok{+}\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id),}
                              \DataTypeTok{data =}\NormalTok{ data_selag_subset3,}\DataTypeTok{family=}\StringTok{"poisson"}\NormalTok{,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\NormalTok{globmod_seedsperfl_B_ns<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{round}\NormalTok{(n_seeds_per_fl)}\OperatorTok{~}
\StringTok{                              }\NormalTok{n_fl}\OperatorTok{+}\NormalTok{FFD_s_y}\OperatorTok{*}\NormalTok{(FFD_mean}\OperatorTok{+}\NormalTok{FFD_sd)}\OperatorTok{+}\NormalTok{grazing_corr}\OperatorTok{+}\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id),}
                         \DataTypeTok{data =}\NormalTok{ data_selag_subset3,}\DataTypeTok{family=}\StringTok{"poisson"}\NormalTok{,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\NormalTok{globmod_pred_GLM1_A_ns<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(}\KeywordTok{round}\NormalTok{(n_pred_seeds),}\KeywordTok{round}\NormalTok{(n_intact_seeds))}\OperatorTok{~}
\StringTok{                             }\NormalTok{(mean_}\DecValTok{3}\OperatorTok{+}\NormalTok{mean_}\DecValTok{4}\OperatorTok{+}\NormalTok{mean_}\DecValTok{5}\OperatorTok{+}\NormalTok{mean_}\DecValTok{6}\NormalTok{)}\OperatorTok{*}\NormalTok{FFD_s_y}\OperatorTok{+}\NormalTok{n_fl,}
                           \DataTypeTok{data=}\NormalTok{data_selag_subset2,}\DataTypeTok{family=}\NormalTok{betabinomial,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\NormalTok{globmod_pred_GLM1_B_ns<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(}\KeywordTok{round}\NormalTok{(n_pred_seeds),}\KeywordTok{round}\NormalTok{(n_intact_seeds))}\OperatorTok{~}
\StringTok{                             }\NormalTok{n_fl}\OperatorTok{+}\NormalTok{FFD_s_y}\OperatorTok{*}\NormalTok{(FFD_mean}\OperatorTok{+}\NormalTok{FFD_sd),}
                           \DataTypeTok{data=}\NormalTok{data_selag_subset2,}\DataTypeTok{family=}\NormalTok{betabinomial,}\DataTypeTok{na.action=}\StringTok{"na.fail"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-40-1.pdf}
\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-40-2.pdf}
\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-40-3.pdf}
\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-40-4.pdf}
\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-40-5.pdf}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-41-1.pdf}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-42-1.pdf}

\hypertarget{how-the-three-interactions-affect-fitness}{%
\section{3. How the three interactions affect
fitness}\label{how-the-three-interactions-affect-fitness}}

\hypertarget{phenotypic-selection-model}{%
\subsection{Phenotypic selection
model}\label{phenotypic-selection-model}}

Because grazing influences (decreases) the number of seeds per flower,
we calculate residuals of number of seeds per flower on grazing to use
in the model.

\hypertarget{classic-selection-model-gaussian}{%
\subsubsection{Classic selection model
(Gaussian)}\label{classic-selection-model-gaussian}}

In this model, we use: fitness relativized within years, FFD and n\_fl
standardized within years,interactions standardized accross years. Main
effects of interactions are not included because fitness was relativized
within years.

N = 2376

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{n_seeds_per_fl_res<-}\KeywordTok{with}\NormalTok{(data_selag,}\KeywordTok{ifelse}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(n_seeds_per_fl),}\OtherTok{NA}\NormalTok{,}
                                           \KeywordTok{residuals}\NormalTok{(}\KeywordTok{lm}\NormalTok{(n_seeds_per_fl}\OperatorTok{~}\NormalTok{grazing_corr,}
                                               \DataTypeTok{data=}\NormalTok{data_selag))))}
\NormalTok{data_selag_means<-data_selag}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{group_by}\NormalTok{(year)}\OperatorTok{%>%}
\StringTok{  }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{n_seeds_per_fl_mean=}\KeywordTok{mean}\NormalTok{(n_seeds_per_fl,}\DataTypeTok{na.rm=}\NormalTok{T),}
                   \DataTypeTok{n_seeds_per_fl_res_mean=}\KeywordTok{mean}\NormalTok{(n_seeds_per_fl_res,}\DataTypeTok{na.rm=}\NormalTok{T),}
                   \DataTypeTok{grazing_mean=}\KeywordTok{mean}\NormalTok{(grazing_corr,}\DataTypeTok{na.rm=}\NormalTok{T),}
                   \DataTypeTok{prop_pred_seeds_mean=}\KeywordTok{mean}\NormalTok{(prop_pred_seeds,}\DataTypeTok{na.rm=}\NormalTok{T),}
                   \DataTypeTok{n_fl_mean=}\KeywordTok{mean}\NormalTok{(n_fl,}\DataTypeTok{na.rm=}\NormalTok{T),}
                   \DataTypeTok{n_fl_sd=}\KeywordTok{sd}\NormalTok{(n_fl,}\DataTypeTok{na.rm=}\NormalTok{T),}
                   \DataTypeTok{n_intact_seeds_mean=}\KeywordTok{mean}\NormalTok{(n_intact_seeds,}\DataTypeTok{na.rm=}\NormalTok{T))}

\NormalTok{data_selag<-data_selag}\OperatorTok{%>%}\KeywordTok{left_join}\NormalTok{(data_selag_means,}\DataTypeTok{by=}\StringTok{"year"}\NormalTok{)}
\CommentTok{# Standardize interactions accross years}
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{n_seeds_per_fl_mean_s<-}\KeywordTok{scale}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{n_seeds_per_fl_mean)}
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{n_seeds_per_fl_res_mean_s<-}\KeywordTok{scale}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{n_seeds_per_fl_res_mean)}
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{grazing_mean_s<-}\KeywordTok{scale}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{grazing_mean)}
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{prop_pred_seeds_mean_s<-}\KeywordTok{scale}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{prop_pred_seeds_mean)}

\CommentTok{# Relativize fitness within years and standardize FFD and n_fl within years}
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{n_intact_seeds_rel_y<-}\KeywordTok{with}\NormalTok{(data_selag,n_intact_seeds}\OperatorTok{/}\NormalTok{n_intact_seeds_mean)}
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{FFD_s_y<-}\KeywordTok{with}\NormalTok{(data_selag,(FFD}\OperatorTok{-}\NormalTok{FFD_mean)}\OperatorTok{/}\NormalTok{FFD_sd)}
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{n_fl_s_y<-}\KeywordTok{with}\NormalTok{(data_selag,(n_fl}\OperatorTok{-}\NormalTok{n_fl_mean)}\OperatorTok{/}\NormalTok{n_fl_sd)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod_int_sel_GLMM<-}\KeywordTok{glmmTMB}\NormalTok{(n_intact_seeds_rel_y }\OperatorTok{~}\StringTok{ }\NormalTok{FFD_s_y}\OperatorTok{+}\NormalTok{n_fl_s_y}\OperatorTok{+}
\StringTok{                         }\NormalTok{FFD_s_y}\OperatorTok{:}\NormalTok{n_seeds_per_fl_res_mean_s}\OperatorTok{+}
\StringTok{                         }\NormalTok{FFD_s_y}\OperatorTok{:}\NormalTok{grazing_mean_s}\OperatorTok{+}
\StringTok{                         }\NormalTok{FFD_s_y}\OperatorTok{:}\NormalTok{prop_pred_seeds_mean_s}\OperatorTok{+}
\StringTok{                         }\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id),data_selag,}\DataTypeTok{family=}\StringTok{"gaussian"}\NormalTok{)}
\NormalTok{mod_int_sel_GLMM<-}\KeywordTok{lmer}\NormalTok{(n_intact_seeds_rel_y }\OperatorTok{~}\StringTok{ }\NormalTok{FFD_s_y}\OperatorTok{+}\NormalTok{n_fl_s_y}\OperatorTok{+}
\StringTok{                         }\NormalTok{FFD_s_y}\OperatorTok{:}\NormalTok{n_seeds_per_fl_res_mean_s}\OperatorTok{+}
\StringTok{                         }\NormalTok{FFD_s_y}\OperatorTok{:}\NormalTok{grazing_mean_s}\OperatorTok{+}
\StringTok{                         }\NormalTok{FFD_s_y}\OperatorTok{:}\NormalTok{prop_pred_seeds_mean_s}\OperatorTok{+}
\StringTok{                         }\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id),data_selag)}
\NormalTok{mod_int_sel_LM<-}\KeywordTok{lm}\NormalTok{(n_intact_seeds_rel_y }\OperatorTok{~}\StringTok{ }\NormalTok{FFD_s_y}\OperatorTok{+}\NormalTok{n_fl_s_y}\OperatorTok{+}
\StringTok{                         }\NormalTok{FFD_s_y}\OperatorTok{:}\NormalTok{n_seeds_per_fl_res_mean_s}\OperatorTok{+}
\StringTok{                         }\NormalTok{FFD_s_y}\OperatorTok{:}\NormalTok{grazing_mean_s}\OperatorTok{+}
\StringTok{                         }\NormalTok{FFD_s_y}\OperatorTok{:}\NormalTok{prop_pred_seeds_mean_s,}
                   \KeywordTok{subset}\NormalTok{(data_selag,}\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(n_intact_seeds_rel_y)}\OperatorTok{&!}\KeywordTok{is.na}\NormalTok{(FFD_s_y)}\OperatorTok{&!}\KeywordTok{is.na}\NormalTok{(n_fl_s_y)}\OperatorTok{&}
\StringTok{                            }\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(n_seeds_per_fl_res_mean_s)}\OperatorTok{&!}\KeywordTok{is.na}\NormalTok{(grazing_mean_s)}\OperatorTok{&}
\StringTok{                            }\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(prop_pred_seeds_mean_s)))}
\CommentTok{# Results of models (t-tests)}
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(mod_int_sel_GLMM)}\OperatorTok{$}\NormalTok{coefficients,}\DataTypeTok{digits=}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lrrrrr@{}}
\toprule
& Estimate & Std. Error & df & t value &
Pr(\textgreater\textbar t\textbar)\tabularnewline
\midrule
\endhead
(Intercept) & 1.025 & 0.045 & 774.7 & 22.86 & 0.000\tabularnewline
FFD\_s\_y & -0.301 & 0.051 & 2325.2 & -5.96 & 0.000\tabularnewline
n\_fl\_s\_y & 0.388 & 0.049 & 2044.4 & 7.99 & 0.000\tabularnewline
FFD\_s\_y:n\_seeds\_per\_fl\_res\_mean\_s & -0.033 & 0.040 & 2343.2 &
-0.82 & 0.412\tabularnewline
FFD\_s\_y:grazing\_mean\_s & 0.134 & 0.032 & 2359.5 & 4.16 &
0.000\tabularnewline
FFD\_s\_y:prop\_pred\_seeds\_mean\_s & -0.026 & 0.041 & 2369.9 & -0.62 &
0.533\tabularnewline
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Analysis of deviance (Wald chisquare tests for GLMM)}
\KeywordTok{kable}\NormalTok{(}\KeywordTok{Anova}\NormalTok{(mod_int_sel_GLMM))}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lrrr@{}}
\toprule
& Chisq & Df & Pr(\textgreater Chisq)\tabularnewline
\midrule
\endhead
FFD\_s\_y & 32.4733126 & 1 & 0.0000000\tabularnewline
n\_fl\_s\_y & 63.9102545 & 1 & 0.0000000\tabularnewline
FFD\_s\_y:n\_seeds\_per\_fl\_res\_mean\_s & 0.6735748 & 1 &
0.4118080\tabularnewline
FFD\_s\_y:grazing\_mean\_s & 17.2873833 & 1 & 0.0000321\tabularnewline
FFD\_s\_y:prop\_pred\_seeds\_mean\_s & 0.3884377 & 1 &
0.5331217\tabularnewline
\bottomrule
\end{longtable}

Significant effect of grazing on selection (but we have seen that the
significance is driven by the year 2017).

\hypertarget{model-diagnostics-with-dharma-3}{%
\paragraph{Model diagnostics with
DHARMa}\label{model-diagnostics-with-dharma-3}}

Simulate residuals of the model:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{simulationOutput_mod_int_sel_GLMM <-}\StringTok{ }
\StringTok{  }\KeywordTok{simulateResiduals}\NormalTok{(}\DataTypeTok{fittedModel =}\NormalTok{ mod_int_sel_GLMM, }\DataTypeTok{n =} \DecValTok{5000}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

qq-plot and plot of residuals vs.~predicted:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(simulationOutput_mod_int_sel_GLMM)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-46-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testDispersion}\NormalTok{(simulationOutput_mod_int_sel_GLMM)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-47-1.pdf}

\begin{verbatim}
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.99973, p-value = 0.9852
## alternative hypothesis: two.sided
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testZeroInflation}\NormalTok{(simulationOutput_mod_int_sel_GLMM)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-48-1.pdf}

\begin{verbatim}
## 
##  DHARMa zero-inflation test via comparison to expected zeros with
##  simulation under H0 = fitted model
## 
## data:  simulationOutput
## ratioObsSim = Inf, p-value < 2.2e-16
## alternative hypothesis: two.sided
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{hist}\NormalTok{(simulationOutput_mod_int_sel_GLMM)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-49-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testResiduals}\NormalTok{(simulationOutput_mod_int_sel_GLMM)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-50-1.pdf}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.19119, p-value < 2.2e-16
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.99973, p-value = 0.9852
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 0.0000e+00, outHigh = 2.3000e+01, nobs = 2.3760e+03, freqH0 =
## 1.9996e-04, p-value < 2.2e-16
## alternative hypothesis: two.sided
\end{verbatim}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.19119, p-value < 2.2e-16
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 0.99973, p-value = 0.9852
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 0.0000e+00, outHigh = 2.3000e+01, nobs = 2.3760e+03, freqH0 =
## 1.9996e-04, p-value < 2.2e-16
## alternative hypothesis: two.sided
\end{verbatim}

\hypertarget{bootstraped-confidence-intervals}{%
\paragraph{Bootstraped confidence
intervals}\label{bootstraped-confidence-intervals}}

\hypertarget{mixed-model}{%
\subparagraph{Mixed model}\label{mixed-model}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{b_par<-}\KeywordTok{bootMer}\NormalTok{(}\DataTypeTok{x=}\NormalTok{mod_int_sel_GLMM,}\DataTypeTok{FUN=}\NormalTok{fixef,}\DataTypeTok{nsim=}\DecValTok{10000}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{confint}\NormalTok{(b_par,}\DataTypeTok{level=}\FloatTok{0.95}\NormalTok{, }\DataTypeTok{method=}\StringTok{"boot"}\NormalTok{) }\CommentTok{# Percentile method}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                                         2.5 %      97.5 %
## (Intercept)                        0.93647979  1.11123645
## FFD_s_y                           -0.39917935 -0.20029124
## n_fl_s_y                           0.29409906  0.48440583
## FFD_s_y:n_seeds_per_fl_res_mean_s -0.10954610  0.04397784
## FFD_s_y:grazing_mean_s             0.07065362  0.19790501
## FFD_s_y:prop_pred_seeds_mean_s    -0.10463158  0.05431076
\end{verbatim}

\hypertarget{lm-elsas-code}{%
\subparagraph{LM (Elsa's code)}\label{lm-elsas-code}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# FFD_s_y}
\NormalTok{slp <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(mod_int_sel_LM) }\KeywordTok{coef}\NormalTok{(mod_int_sel_LM)[}\DecValTok{2}\NormalTok{]}
\NormalTok{b <-}\StringTok{ }\NormalTok{car}\OperatorTok{::}\KeywordTok{Boot}\NormalTok{(mod_int_sel_LM,slp, }\DataTypeTok{R=}\DecValTok{10000}\NormalTok{) }\CommentTok{# note the capital B}
\NormalTok{b1 <-}\StringTok{ }\NormalTok{boot}\OperatorTok{::}\KeywordTok{boot.ci}\NormalTok{(b,}\DataTypeTok{type=}\StringTok{"bca"}\NormalTok{)}
\NormalTok{FFD_s_y_ci <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(b1}\OperatorTok{$}\NormalTok{bca[}\DecValTok{1}\NormalTok{,}\DecValTok{4}\OperatorTok{:}\DecValTok{5}\NormalTok{])}
\KeywordTok{rm}\NormalTok{(slp, b, b1)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# n_fl_s_y}
\NormalTok{slp <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(mod_int_sel_LM) }\KeywordTok{coef}\NormalTok{(mod_int_sel_LM)[}\DecValTok{3}\NormalTok{]}
\NormalTok{b <-}\StringTok{ }\NormalTok{car}\OperatorTok{::}\KeywordTok{Boot}\NormalTok{(mod_int_sel_LM,slp, }\DataTypeTok{R=}\DecValTok{10000}\NormalTok{) }\CommentTok{# note the capital B}
\NormalTok{b1 <-}\StringTok{ }\NormalTok{boot}\OperatorTok{::}\KeywordTok{boot.ci}\NormalTok{(b,}\DataTypeTok{type=}\StringTok{"bca"}\NormalTok{)}
\NormalTok{n_fl_s_y_ci <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(b1}\OperatorTok{$}\NormalTok{bca[}\DecValTok{1}\NormalTok{,}\DecValTok{4}\OperatorTok{:}\DecValTok{5}\NormalTok{])}
\KeywordTok{rm}\NormalTok{(slp, b, b1)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# FFD_s_y:n_seeds_per_fl_res_mean_s}
\NormalTok{slp <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(mod_int_sel_LM) }\KeywordTok{coef}\NormalTok{(mod_int_sel_LM)[}\DecValTok{4}\NormalTok{]}
\NormalTok{b <-}\StringTok{ }\NormalTok{car}\OperatorTok{::}\KeywordTok{Boot}\NormalTok{(mod_int_sel_LM,slp, }\DataTypeTok{R=}\DecValTok{10000}\NormalTok{) }\CommentTok{# note the capital B}
\NormalTok{b1 <-}\StringTok{ }\NormalTok{boot}\OperatorTok{::}\KeywordTok{boot.ci}\NormalTok{(b,}\DataTypeTok{type=}\StringTok{"bca"}\NormalTok{)}
\NormalTok{FFD_s_y_seedl_ci <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(b1}\OperatorTok{$}\NormalTok{bca[}\DecValTok{1}\NormalTok{,}\DecValTok{4}\OperatorTok{:}\DecValTok{5}\NormalTok{])}
\KeywordTok{rm}\NormalTok{(slp, b, b1)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# FFD_s_y:grazing_mean_s}
\NormalTok{slp <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(mod_int_sel_LM) }\KeywordTok{coef}\NormalTok{(mod_int_sel_LM)[}\DecValTok{5}\NormalTok{]}
\NormalTok{b <-}\StringTok{ }\NormalTok{car}\OperatorTok{::}\KeywordTok{Boot}\NormalTok{(mod_int_sel_LM,slp, }\DataTypeTok{R=}\DecValTok{10000}\NormalTok{) }\CommentTok{# note the capital B}
\NormalTok{b1 <-}\StringTok{ }\NormalTok{boot}\OperatorTok{::}\KeywordTok{boot.ci}\NormalTok{(b,}\DataTypeTok{type=}\StringTok{"bca"}\NormalTok{)}
\NormalTok{FFD_s_y_graz_ci <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(b1}\OperatorTok{$}\NormalTok{bca[}\DecValTok{1}\NormalTok{,}\DecValTok{4}\OperatorTok{:}\DecValTok{5}\NormalTok{])}
\KeywordTok{rm}\NormalTok{(slp, b, b1)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# prop_pred_seeds_mean_s}
\NormalTok{slp <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(mod_int_sel_LM) }\KeywordTok{coef}\NormalTok{(mod_int_sel_LM)[}\DecValTok{6}\NormalTok{]}
\NormalTok{b <-}\StringTok{ }\NormalTok{car}\OperatorTok{::}\KeywordTok{Boot}\NormalTok{(mod_int_sel_LM,slp, }\DataTypeTok{R=}\DecValTok{10000}\NormalTok{) }\CommentTok{# note the capital B}
\NormalTok{b1 <-}\StringTok{ }\NormalTok{boot}\OperatorTok{::}\KeywordTok{boot.ci}\NormalTok{(b,}\DataTypeTok{type=}\StringTok{"bca"}\NormalTok{)}
\NormalTok{FFD_s_y_pred_ci <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(b1}\OperatorTok{$}\NormalTok{bca[}\DecValTok{1}\NormalTok{,}\DecValTok{4}\OperatorTok{:}\DecValTok{5}\NormalTok{])}
\KeywordTok{rm}\NormalTok{(slp, b, b1)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Save confidence intervals as a table}
\NormalTok{lower_A <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(FFD_s_y_ci[}\DecValTok{1}\NormalTok{,] ,n_fl_s_y_ci[}\DecValTok{1}\NormalTok{,])}
\NormalTok{lower_B <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(lower_A ,FFD_s_y_seedl_ci[}\DecValTok{1}\NormalTok{,])}
\NormalTok{lower_C <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(lower_B ,FFD_s_y_graz_ci[}\DecValTok{1}\NormalTok{,])}
\NormalTok{lower_D <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(lower_C ,FFD_s_y_pred_ci[}\DecValTok{1}\NormalTok{,])}
\NormalTok{lower <-}\StringTok{ }\NormalTok{lower_D}

\NormalTok{upper_A <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(FFD_s_y_ci[}\DecValTok{2}\NormalTok{,] ,n_fl_s_y_ci[}\DecValTok{2}\NormalTok{,])}
\NormalTok{upper_B <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(upper_A ,FFD_s_y_seedl_ci[}\DecValTok{2}\NormalTok{,])}
\NormalTok{upper_C <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(upper_B ,FFD_s_y_graz_ci[}\DecValTok{2}\NormalTok{,])}
\NormalTok{upper_D <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(upper_C ,FFD_s_y_pred_ci[}\DecValTok{2}\NormalTok{,])}
\NormalTok{upper <-}\StringTok{ }\NormalTok{upper_D}


\NormalTok{BCIs_mod_int_sel_LM <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(lower, upper) }
\KeywordTok{rownames}\NormalTok{(BCIs_mod_int_sel_LM) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"FFD_s_y"}\NormalTok{,}\StringTok{"n_fl_s_y"}\NormalTok{,}\StringTok{"FFD_s_y:seedfl"}\NormalTok{,}
                                   \StringTok{"FFD_s_y:graz"}\NormalTok{,}\StringTok{"FFD_s_y:pred"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{negative-binomial-distribution-with-offset}{%
\subsubsection{Negative binomial distribution with
offset}\label{negative-binomial-distribution-with-offset}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod_int_sel_GLMM2<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{round}\NormalTok{(n_intact_seeds) }\OperatorTok{~}\StringTok{ }\NormalTok{FFD_s_y}\OperatorTok{+}\NormalTok{n_fl_s_y}\OperatorTok{+}
\StringTok{                  }\NormalTok{FFD_s_y}\OperatorTok{:}\NormalTok{n_seeds_per_fl_res_mean_s}\OperatorTok{+}
\StringTok{                  }\NormalTok{FFD_s_y}\OperatorTok{:}\NormalTok{grazing_mean_s}\OperatorTok{+}
\StringTok{                  }\NormalTok{FFD_s_y}\OperatorTok{:}\NormalTok{prop_pred_seeds_mean_s}\OperatorTok{+}
\StringTok{                  }\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id),data_selag,}\DataTypeTok{family=}\StringTok{"nbinom2"}\NormalTok{,}\DataTypeTok{offset=}\NormalTok{n_intact_seeds_mean)}
\CommentTok{# Results of models (t-tests)}
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(mod_int_sel_GLMM2)}\OperatorTok{$}\NormalTok{coefficients,}\DataTypeTok{digits=}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{table}

\centering
\begin{tabular}[t]{l|r|r|r|r}
\hline
  & Estimate & Std. Error & z value & Pr(>|z|)\\
\hline
(Intercept) & -3.136 & 0.112 & -28.02 & 0.000\\
\hline
FFD\_s\_y & -0.573 & 0.107 & -5.35 & 0.000\\
\hline
n\_fl\_s\_y & 0.382 & 0.094 & 4.08 & 0.000\\
\hline
FFD\_s\_y:n\_seeds\_per\_fl\_res\_mean\_s & -0.073 & 0.062 & -1.17 & 0.242\\
\hline
FFD\_s\_y:grazing\_mean\_s & 0.165 & 0.078 & 2.12 & 0.034\\
\hline
FFD\_s\_y:prop\_pred\_seeds\_mean\_s & -0.212 & 0.084 & -2.53 & 0.011\\
\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Analysis of deviance (Wald chisquare tests for GLMM)}
\KeywordTok{kable}\NormalTok{(}\KeywordTok{Anova}\NormalTok{(mod_int_sel_GLMM2))}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lrrr@{}}
\toprule
& Chisq & Df & Pr(\textgreater Chisq)\tabularnewline
\midrule
\endhead
FFD\_s\_y & 50.876941 & 1 & 0.0000000\tabularnewline
n\_fl\_s\_y & 16.671102 & 1 & 0.0000445\tabularnewline
FFD\_s\_y:n\_seeds\_per\_fl\_res\_mean\_s & 1.367368 & 1 &
0.2422646\tabularnewline
FFD\_s\_y:grazing\_mean\_s & 4.509392 & 1 & 0.0337092\tabularnewline
FFD\_s\_y:prop\_pred\_seeds\_mean\_s & 6.390211 & 1 &
0.0114751\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{graphs-of-the-interaction-ffdgrazing}{%
\subsubsection{Graphs of the interaction
FFD:grazing}\label{graphs-of-the-interaction-ffdgrazing}}

Graph based on GLMMs with non-standardized interactions - to show real
values of grazing in the color bar.

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-60-1.pdf}

The slope of the relationship among fitness and FFD is more positive in
years with higher proportions of grazing  selection for later flowering
in those years

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-61-1.pdf}

\hypertarget{effects-on-selection-gradients-for-each-year}{%
\subsubsection{Effects on selection gradients for each
year}\label{effects-on-selection-gradients-for-each-year}}

Calculation of selection gradients for each year

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{selgrads_FFD<-}\KeywordTok{data.frame}\NormalTok{(data_selag }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(year) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{do}\NormalTok{(}\DataTypeTok{model =} \KeywordTok{lm}\NormalTok{(n_intact_seeds_rel_y }\OperatorTok{~}\StringTok{ }\NormalTok{FFD_s_y}\OperatorTok{+}\NormalTok{n_fl_s_y, }\DataTypeTok{data =}\NormalTok{ .)) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{tidy}\NormalTok{(model))}
\NormalTok{selgrads_FFD}\OperatorTok{$}\NormalTok{sig<-}\KeywordTok{ifelse}\NormalTok{(selgrads_FFD}\OperatorTok{$}\NormalTok{p.value}\OperatorTok{<}\FloatTok{0.05}\NormalTok{,}\StringTok{"*"}\NormalTok{,}\StringTok{""}\NormalTok{) }
\KeywordTok{kable}\NormalTok{(}\KeywordTok{subset}\NormalTok{(selgrads_FFD,term}\OperatorTok{==}\StringTok{"FFD_s_y"}\NormalTok{),}\DataTypeTok{digits=}\DecValTok{3}\NormalTok{)  }\CommentTok{#Linear selection gradients for FFD}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lrlrrrrl@{}}
\toprule
& year & term & estimate & std.error & statistic & p.value &
sig\tabularnewline
\midrule
\endhead
2 & 1987 & FFD\_s\_y & -0.078 & 0.088 & -0.883 & 0.378 &\tabularnewline
5 & 1988 & FFD\_s\_y & -0.088 & 0.111 & -0.789 & 0.431 &\tabularnewline
8 & 1989 & FFD\_s\_y & -0.144 & 0.143 & -1.010 & 0.315 &\tabularnewline
11 & 1990 & FFD\_s\_y & -0.286 & 0.175 & -1.631 & 0.105 &\tabularnewline
14 & 1991 & FFD\_s\_y & -0.353 & 0.098 & -3.597 & 0.000 &
*\tabularnewline
17 & 1992 & FFD\_s\_y & -0.463 & 0.199 & -2.323 & 0.022 &
*\tabularnewline
20 & 1993 & FFD\_s\_y & -0.340 & 0.152 & -2.236 & 0.027 &
*\tabularnewline
23 & 1994 & FFD\_s\_y & -0.499 & 0.213 & -2.340 & 0.020 &
*\tabularnewline
26 & 1996 & FFD\_s\_y & -0.170 & 0.101 & -1.684 & 0.095 &\tabularnewline
29 & 2006 & FFD\_s\_y & -0.221 & 0.123 & -1.796 & 0.076 &\tabularnewline
32 & 2007 & FFD\_s\_y & -0.380 & 0.135 & -2.816 & 0.006 &
*\tabularnewline
35 & 2008 & FFD\_s\_y & -0.206 & 0.115 & -1.796 & 0.076 &\tabularnewline
38 & 2009 & FFD\_s\_y & -0.056 & 0.353 & -0.158 & 0.875 &\tabularnewline
41 & 2010 & FFD\_s\_y & -0.495 & 0.201 & -2.459 & 0.016 &
*\tabularnewline
44 & 2011 & FFD\_s\_y & -0.308 & 0.230 & -1.338 & 0.185 &\tabularnewline
47 & 2012 & FFD\_s\_y & -0.685 & 0.216 & -3.174 & 0.002 &
*\tabularnewline
50 & 2013 & FFD\_s\_y & -0.450 & 0.351 & -1.284 & 0.204 &\tabularnewline
53 & 2014 & FFD\_s\_y & -0.803 & 0.218 & -3.676 & 0.001 &
*\tabularnewline
56 & 2015 & FFD\_s\_y & 0.090 & 0.341 & 0.264 & 0.794 &\tabularnewline
59 & 2016 & FFD\_s\_y & -0.056 & 0.100 & -0.563 & 0.575 &\tabularnewline
62 & 2017 & FFD\_s\_y & -0.021 & 0.608 & -0.034 & 0.973 &\tabularnewline
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#FFD * (selection for early flowering) in 1991,1992,1993,1994,2007,2010,2012,2014 (as in EL paper)}
\end{Highlighting}
\end{Shaded}

Plot selection gradients vs mean interactions

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-63-1.pdf}

Models for effects of mean interactions on selection gradients

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(}\KeywordTok{lm}\NormalTok{(estimate}\OperatorTok{~}\NormalTok{n_seeds_per_fl_res_mean,data_selag_means))}\OperatorTok{$}\NormalTok{coefficients)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lrrrr@{}}
\toprule
& Estimate & Std. Error & t value &
Pr(\textgreater\textbar t\textbar)\tabularnewline
\midrule
\endhead
(Intercept) & -0.2855260 & 0.0521763 & -5.4723276 &
0.000028\tabularnewline
n\_seeds\_per\_fl\_res\_mean & -0.0340912 & 0.5317882 & -0.0641067 &
0.949555\tabularnewline
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(}\KeywordTok{lm}\NormalTok{(estimate}\OperatorTok{~}\NormalTok{grazing_mean,data_selag_means))}\OperatorTok{$}\NormalTok{coefficients)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lrrrr@{}}
\toprule
& Estimate & Std. Error & t value &
Pr(\textgreater\textbar t\textbar)\tabularnewline
\midrule
\endhead
(Intercept) & -0.3546187 & 0.0584607 & -6.065936 &
0.0000078\tabularnewline
grazing\_mean & 0.5466662 & 0.2826267 & 1.934234 &
0.0681187\tabularnewline
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(}\KeywordTok{lm}\NormalTok{(estimate}\OperatorTok{~}\NormalTok{prop_pred_seeds_mean,data_selag_means))}\OperatorTok{$}\NormalTok{coefficients)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lrrrr@{}}
\toprule
& Estimate & Std. Error & t value &
Pr(\textgreater\textbar t\textbar)\tabularnewline
\midrule
\endhead
(Intercept) & -0.2154195 & 0.0922053 & -2.336303 &
0.0305837\tabularnewline
prop\_pred\_seeds\_mean & -0.1742028 & 0.1907548 & -0.913229 &
0.3725655\tabularnewline
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(}\KeywordTok{lm}\NormalTok{(estimate}\OperatorTok{~}\NormalTok{n_seeds_per_fl_res_mean}\OperatorTok{+}\NormalTok{grazing_mean}\OperatorTok{+}\NormalTok{prop_pred_seeds_mean,}
\NormalTok{                 data_selag_means))}\OperatorTok{$}\NormalTok{coefficients)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lrrrr@{}}
\toprule
& Estimate & Std. Error & t value &
Pr(\textgreater\textbar t\textbar)\tabularnewline
\midrule
\endhead
(Intercept) & -0.2298934 & 0.1077404 & -2.1337718 &
0.0477263\tabularnewline
n\_seeds\_per\_fl\_res\_mean & -0.5782329 & 0.5835095 & -0.9909572 &
0.3356026\tabularnewline
grazing\_mean & 0.5875429 & 0.2859367 & 2.0548003 &
0.0556002\tabularnewline
prop\_pred\_seeds\_mean & -0.2891049 & 0.2123263 & -1.3616066 &
0.1910960\tabularnewline
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(}\KeywordTok{lm}\NormalTok{(estimate}\OperatorTok{~}\NormalTok{n_seeds_per_fl_res_mean}\OperatorTok{+}\NormalTok{grazing_mean}\OperatorTok{+}\NormalTok{prop_pred_seeds_mean,}
                 \KeywordTok{subset}\NormalTok{(data_selag_means,year}\OperatorTok{<}\DecValTok{2017}\NormalTok{)))}\OperatorTok{$}\NormalTok{coefficients)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lrrrr@{}}
\toprule
& Estimate & Std. Error & t value &
Pr(\textgreater\textbar t\textbar)\tabularnewline
\midrule
\endhead
(Intercept) & -0.2548674 & 0.1315064 & -1.9380611 &
0.0704687\tabularnewline
n\_seeds\_per\_fl\_res\_mean & -0.5525145 & 0.6036189 & -0.9153367 &
0.3736046\tabularnewline
grazing\_mean & 0.7641228 & 0.5821594 & 1.3125663 &
0.2078464\tabularnewline
prop\_pred\_seeds\_mean & -0.2644688 & 0.2290252 & -1.1547585 &
0.2651452\tabularnewline
\bottomrule
\end{longtable}

No significant effects of yearly mean interactions on yearly selection
gradients (but effect of grazing is ALMOST significant)

\hypertarget{models-of-fitness-vs.-the-three-interactions}{%
\subsection{Models of fitness vs.~the three
interactions}\label{models-of-fitness-vs.-the-three-interactions}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data_selag_subset4<-}\KeywordTok{subset}\NormalTok{(data_selag,}\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(n_intact_seeds)}\OperatorTok{&!}\KeywordTok{is.na}\NormalTok{(n_seeds_per_fl)}\OperatorTok{&}
\StringTok{                             }\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(grazing_corr)}\OperatorTok{&!}\KeywordTok{is.na}\NormalTok{(n_fl)}\OperatorTok{&!}\KeywordTok{is.na}\NormalTok{(FFD_s_y))}
\NormalTok{data_selag_subset4}\OperatorTok{$}\NormalTok{n_intact_seeds_pres<-}\KeywordTok{with}\NormalTok{(data_selag_subset4,}
                                             \KeywordTok{ifelse}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(n_intact_seeds),}\OtherTok{NA}\NormalTok{,}
                                                    \KeywordTok{ifelse}\NormalTok{(n_intact_seeds}\OperatorTok{>}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{)))}

\NormalTok{model_fitness_pres<-}\KeywordTok{glmmTMB}\NormalTok{(n_intact_seeds_pres}\OperatorTok{~}\KeywordTok{scale}\NormalTok{(grazing_corr)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(n_seeds_per_fl)}\OperatorTok{+}
\StringTok{                              }\KeywordTok{scale}\NormalTok{(n_fl)}\OperatorTok{+}\NormalTok{FFD_s_y}\OperatorTok{+}\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id),data_selag_subset4,}\DataTypeTok{family=}\StringTok{"binomial"}\NormalTok{) }
\CommentTok{# Very small variance of id if including it as a random effect --> but include it still}
\CommentTok{# Coefs were very similar to those in GLM}

\NormalTok{model_fitness_count<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{round}\NormalTok{(n_intact_seeds)}\OperatorTok{~}
\StringTok{                               }\KeywordTok{scale}\NormalTok{(n_seeds_per_fl)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(grazing_corr)}\OperatorTok{+}
\StringTok{                               }\KeywordTok{scale}\NormalTok{(prop_pred_seeds)}\OperatorTok{+}\KeywordTok{scale}\NormalTok{(n_fl)}\OperatorTok{+}\NormalTok{FFD_s_y,}
                             \KeywordTok{subset}\NormalTok{(data_selag_subset4,n_seeds}\OperatorTok{>}\DecValTok{0}\NormalTok{),}\DataTypeTok{family=}\StringTok{"nbinom2"}\NormalTok{)}
\CommentTok{# GLM because most ids with only one observation}

\KeywordTok{nobs}\NormalTok{(model_fitness_pres) }\CommentTok{# All plants}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2376
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{nobs}\NormalTok{(model_fitness_count) }\CommentTok{# Plants with > 0 seeds}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1281
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(model_fitness_pres)}\OperatorTok{$}\NormalTok{coefficients)}
\end{Highlighting}
\end{Shaded}

\begin{table}

\centering
\begin{tabular}[t]{l|r|r|r|r}
\hline
  & Estimate & Std. Error & z value & Pr(>|z|)\\
\hline
(Intercept) & 0.9521072 & 0.1016856 & 9.363245 & 0.0e+00\\
\hline
scale(grazing\_corr) & -0.5099979 & 0.0923689 & -5.521314 & 0.0e+00\\
\hline
scale(n\_seeds\_per\_fl) & 4.4626634 & 0.1993361 & 22.387633 & 0.0e+00\\
\hline
scale(n\_fl) & 1.0675626 & 0.1130809 & 9.440698 & 0.0e+00\\
\hline
FFD\_s\_y & -0.4198858 & 0.0889383 & -4.721092 & 2.3e-06\\
\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{kable}\NormalTok{(}\KeywordTok{summary}\NormalTok{(model_fitness_count)}\OperatorTok{$}\NormalTok{coefficients)}
\end{Highlighting}
\end{Shaded}

\begin{table}

\centering
\begin{tabular}[t]{l|r|r|r|r}
\hline
  & Estimate & Std. Error & z value & Pr(>|z|)\\
\hline
(Intercept) & 1.8120118 & 0.0216203 & 83.810675 & 0.0000000\\
\hline
scale(n\_seeds\_per\_fl) & 0.4742952 & 0.0248699 & 19.071065 & 0.0000000\\
\hline
scale(grazing\_corr) & -0.0015237 & 0.0195049 & -0.078120 & 0.9377326\\
\hline
scale(prop\_pred\_seeds) & -0.7971612 & 0.0244887 & -32.552234 & 0.0000000\\
\hline
scale(n\_fl) & 0.6444867 & 0.0289065 & 22.295580 & 0.0000000\\
\hline
FFD\_s\_y & -0.1645894 & 0.0242691 & -6.781855 & 0.0000000\\
\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\centering
\begin{tabular}[t]{}
\hline

\hline
\end{tabular}
\end{table}

\hypertarget{model-diagnostics-with-dharma-4}{%
\paragraph{Model diagnostics with
DHARMa}\label{model-diagnostics-with-dharma-4}}

Simulate residuals of the model:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# simulationOutput_model_fitness_pres <- }
\CommentTok{#     simulateResiduals(fittedModel = model_fitness_pres, n = 5000) # Error}
\NormalTok{simulationOutput_model_fitness_count <-}\StringTok{ }
\StringTok{   }\KeywordTok{simulateResiduals}\NormalTok{(}\DataTypeTok{fittedModel =}\NormalTok{ model_fitness_count, }\DataTypeTok{n =} \DecValTok{5000}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

qq-plot and plot of residuals vs.~predicted:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(simulationOutput_model_fitness_count)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-67-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{testResiduals}\NormalTok{(simulationOutput_model_fitness_count)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-67-2.pdf}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.032285, p-value = 0.1384
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 2.1721, p-value = 0.0948
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 4.0000e+00, outHigh = 0.0000e+00, nobs = 1.2810e+03, freqH0 =
## 1.9996e-04, p-value = 1
## alternative hypothesis: two.sided
\end{verbatim}

\begin{verbatim}
## $uniformity
## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.032285, p-value = 0.1384
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
##  DHARMa nonparametric dispersion test via sd of residuals fitted vs.
##  simulated
## 
## data:  simulationOutput
## ratioObsSim = 2.1721, p-value = 0.0948
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
##  DHARMa outlier test based on exact binomial test
## 
## data:  simulationOutput
## outLow = 4.0000e+00, outHigh = 0.0000e+00, nobs = 1.2810e+03, freqH0 =
## 1.9996e-04, p-value = 1
## alternative hypothesis: two.sided
\end{verbatim}

\hypertarget{graphs-1}{%
\paragraph{Graphs}\label{graphs-1}}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-68-1.pdf}
\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-68-2.pdf}
\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-68-3.pdf}
\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-68-4.pdf}
\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-68-5.pdf}
\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-68-6.pdf}

\hypertarget{different-grazing-estimates}{%
\section{Different grazing
estimates}\label{different-grazing-estimates}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data_selag}\OperatorTok{$}\NormalTok{grazing_type<-}\KeywordTok{with}\NormalTok{(data_selag,}\KeywordTok{ifelse}\NormalTok{(year}\OperatorTok{<}\DecValTok{1997}\OperatorTok{|}\NormalTok{year}\OperatorTok{>}\DecValTok{2015}\NormalTok{,}\StringTok{"flowers"}\NormalTok{,}
                                                \KeywordTok{ifelse}\NormalTok{(year}\OperatorTok{==}\DecValTok{2006}\NormalTok{,}\StringTok{"shoots"}\NormalTok{,}\StringTok{"volume"}\NormalTok{)))}
\KeywordTok{summary}\NormalTok{(}\KeywordTok{lm}\NormalTok{(n_seeds_per_fl}\OperatorTok{~}\NormalTok{grazing_corr}\OperatorTok{*}\NormalTok{grazing_type,data_selag))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = n_seeds_per_fl ~ grazing_corr * grazing_type, data = data_selag)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.7704 -0.6861 -0.2148  0.3096 10.2296 
## 
## Coefficients:
##                                 Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                      0.77038    0.02571  29.962   <2e-16 ***
## grazing_corr                    -0.74475    0.07508  -9.919   <2e-16 ***
## grazing_typeshoots              -0.05944    0.11663  -0.510   0.6103    
## grazing_typevolume              -0.08426    0.04623  -1.823   0.0684 .  
## grazing_corr:grazing_typeshoots  0.65907    0.30790   2.141   0.0324 *  
## grazing_corr:grazing_typevolume -0.09355    0.21093  -0.444   0.6574    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.9599 on 2407 degrees of freedom
##   (4945 observations deleted due to missingness)
## Multiple R-squared:  0.04657,    Adjusted R-squared:  0.04459 
## F-statistic: 23.51 on 5 and 2407 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{Anova}\NormalTok{(}\KeywordTok{lm}\NormalTok{(n_seeds_per_fl}\OperatorTok{~}\NormalTok{grazing_corr}\OperatorTok{*}\NormalTok{grazing_type,data_selag))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Anova Table (Type II tests)
## 
## Response: n_seeds_per_fl
##                            Sum Sq   Df  F value  Pr(>F)    
## grazing_corr               102.80    1 111.5778 < 2e-16 ***
## grazing_type                 4.53    2   2.4585 0.08578 .  
## grazing_corr:grazing_type    4.59    2   2.4904 0.08309 .  
## Residuals                 2217.74 2407                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(}\KeywordTok{glm}\NormalTok{(n_seeds_per_fl}\OperatorTok{~}\NormalTok{grazing_corr}\OperatorTok{*}\NormalTok{grazing_type,data_selag,}\DataTypeTok{family=}\NormalTok{poisson))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = n_seeds_per_fl ~ grazing_corr * grazing_type, family = poisson, 
##     data = data_selag)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.2463  -1.1806  -0.3418   0.3410   6.1537  
## 
## Coefficients:
##                                 Estimate Std. Error z value Pr(>|z|)    
## (Intercept)                     -0.25279    0.03059  -8.264  < 2e-16 ***
## grazing_corr                    -2.58746    0.27479  -9.416  < 2e-16 ***
## grazing_typeshoots              -0.08819    0.14411  -0.612   0.5406    
## grazing_typevolume              -0.10831    0.05755  -1.882   0.0598 .  
## grazing_corr:grazing_typeshoots  2.46000    0.47365   5.194 2.06e-07 ***
## grazing_corr:grazing_typevolume -0.19408    0.65080  -0.298   0.7655    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 2905.6  on 2412  degrees of freedom
## Residual deviance: 2652.4  on 2407  degrees of freedom
##   (4945 observations deleted due to missingness)
## AIC: Inf
## 
## Number of Fisher Scoring iterations: 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{Anova}\NormalTok{(}\KeywordTok{glm}\NormalTok{(n_seeds_per_fl}\OperatorTok{~}\NormalTok{grazing_corr}\OperatorTok{*}\NormalTok{grazing_type,data_selag,}\DataTypeTok{family=}\NormalTok{poisson))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Deviance Table (Type II tests)
## 
## Response: n_seeds_per_fl
##                           LR Chisq Df Pr(>Chisq)    
## grazing_corr               228.346  1  < 2.2e-16 ***
## grazing_type                 5.717  2    0.05736 .  
## grazing_corr:grazing_type   23.457  2   8.06e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\hypertarget{variation-ffd-mean-ffd-sd-climatic-variables-and-intensities-of-the-three-interactions-among-years.}{%
\section{Variation FFD mean, FFD SD, climatic Variables, and intensities
of the three interactions among
years.}\label{variation-ffd-mean-ffd-sd-climatic-variables-and-intensities-of-the-three-interactions-among-years.}}

\hypertarget{values}{%
\subsection{Values}\label{values}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# FFD mean and SD}
\NormalTok{data_selag}\OperatorTok{%>%}
\StringTok{  }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{group_by}\NormalTok{(year)}\OperatorTok{%>%}
\StringTok{  }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{FFD_mean=}\KeywordTok{mean}\NormalTok{(FFD,}\DataTypeTok{na.rm=}\NormalTok{T),}
                   \DataTypeTok{FFD_SD=}\KeywordTok{sd}\NormalTok{(FFD,}\DataTypeTok{na.rm=}\NormalTok{T))}\OperatorTok{%>%}
\StringTok{  }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{FFD_mean_min=}\KeywordTok{min}\NormalTok{(FFD_mean),}
                   \DataTypeTok{FFD_mean_max=}\KeywordTok{max}\NormalTok{(FFD_mean),}
                   \DataTypeTok{FFD_mean_mean=}\KeywordTok{mean}\NormalTok{(FFD_mean),}
                   \DataTypeTok{FFD_mean_sd=}\KeywordTok{sd}\NormalTok{(FFD_mean),}
                   \DataTypeTok{FFD_SD_min=}\KeywordTok{min}\NormalTok{(FFD_SD),}
                   \DataTypeTok{FFD_SD_max=}\KeywordTok{max}\NormalTok{(FFD_SD),}
                   \DataTypeTok{FFD_SD_mean=}\KeywordTok{mean}\NormalTok{(FFD_SD),}
                   \DataTypeTok{FFD_SD_sd=}\KeywordTok{sd}\NormalTok{(FFD_SD))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1 x 8
##   FFD_mean_min FFD_mean_max FFD_mean_mean FFD_mean_sd FFD_SD_min FFD_SD_max
##          <dbl>        <dbl>         <dbl>       <dbl>      <dbl>      <dbl>
## 1         48.1         71.6          57.5        5.43       2.24       7.36
## # ... with 2 more variables: FFD_SD_mean <dbl>, FFD_SD_sd <dbl>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Temperatures}
\KeywordTok{range}\NormalTok{(}\KeywordTok{unique}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{mean_}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -3.774194  5.356452
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{mean}\NormalTok{(}\KeywordTok{unique}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{mean_}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.466429
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sd}\NormalTok{(}\KeywordTok{unique}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{mean_}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2.718082
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{range}\NormalTok{(}\KeywordTok{unique}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{mean_}\DecValTok{4}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3.685476 8.438333
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{mean}\NormalTok{(}\KeywordTok{unique}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{mean_}\DecValTok{4}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5.727283
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sd}\NormalTok{(}\KeywordTok{unique}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{mean_}\DecValTok{4}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.37677
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{range}\NormalTok{(}\KeywordTok{unique}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{mean_}\DecValTok{5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  8.258065 13.029032
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{mean}\NormalTok{(}\KeywordTok{unique}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{mean_}\DecValTok{5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 10.88341
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sd}\NormalTok{(}\KeywordTok{unique}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{mean_}\DecValTok{5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.361637
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{range}\NormalTok{(}\KeywordTok{unique}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{mean_}\DecValTok{6}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 11.96333 17.31000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{mean}\NormalTok{(}\KeywordTok{unique}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{mean_}\DecValTok{6}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 14.82844
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sd}\NormalTok{(}\KeywordTok{unique}\NormalTok{(data_selag}\OperatorTok{$}\NormalTok{mean_}\DecValTok{6}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.452146
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Interactions}
\NormalTok{data_selag_means}\OperatorTok{%>%}
\StringTok{  }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{grazing_mean_min=}\KeywordTok{min}\NormalTok{(grazing_mean),}
                   \DataTypeTok{grazing_mean_max=}\KeywordTok{max}\NormalTok{(grazing_mean),}
                   \DataTypeTok{grazing_mean_mean=}\KeywordTok{mean}\NormalTok{(grazing_mean),}
                   \DataTypeTok{grazing_mean_sd=}\KeywordTok{sd}\NormalTok{(grazing_mean),}
                   \DataTypeTok{n_seeds_per_fl_mean_min=}\KeywordTok{min}\NormalTok{(n_seeds_per_fl_mean),}
                   \DataTypeTok{n_seeds_per_fl_mean_max=}\KeywordTok{max}\NormalTok{(n_seeds_per_fl_mean),}
                   \DataTypeTok{n_seeds_per_fl_mean_mean=}\KeywordTok{mean}\NormalTok{(n_seeds_per_fl_mean),}
                   \DataTypeTok{n_seeds_per_fl_mean_sd=}\KeywordTok{sd}\NormalTok{(n_seeds_per_fl_mean),}
                   \DataTypeTok{prop_pred_seeds_mean_min=}\KeywordTok{min}\NormalTok{(prop_pred_seeds_mean),}
                   \DataTypeTok{prop_pred_seeds_mean_max=}\KeywordTok{max}\NormalTok{(prop_pred_seeds_mean),}
                   \DataTypeTok{prop_pred_seeds_mean_mean=}\KeywordTok{mean}\NormalTok{(prop_pred_seeds_mean),}
                   \DataTypeTok{prop_pred_seeds_mean_sd=}\KeywordTok{sd}\NormalTok{(prop_pred_seeds_mean))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1 x 12
##   grazing_mean_min grazing_mean_max grazing_mean_me~ grazing_mean_sd
##              <dbl>            <dbl>            <dbl>           <dbl>
## 1           0.0107            0.756            0.125           0.169
## # ... with 8 more variables: n_seeds_per_fl_mean_min <dbl>,
## #   n_seeds_per_fl_mean_max <dbl>, n_seeds_per_fl_mean_mean <dbl>,
## #   n_seeds_per_fl_mean_sd <dbl>, prop_pred_seeds_mean_min <dbl>,
## #   prop_pred_seeds_mean_max <dbl>, prop_pred_seeds_mean_mean <dbl>,
## #   prop_pred_seeds_mean_sd <dbl>
\end{verbatim}

\hypertarget{plots}{%
\subsection{Plots}\label{plots}}

Read weather data

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{weather<-}\KeywordTok{read.table}\NormalTok{(}\StringTok{"C:/Users/user/Dropbox/SU/Projects/lathyrus/lathyrus_ms3/data/weather.csv"}\NormalTok{,}
                    \DataTypeTok{header=}\NormalTok{T,}\DataTypeTok{sep=}\StringTok{"}\CharTok{\textbackslash{}t}\StringTok{"}\NormalTok{,}\DataTypeTok{dec=}\StringTok{"."}\NormalTok{) }
\NormalTok{weather<-}\KeywordTok{subset}\NormalTok{(}\KeywordTok{subset}\NormalTok{(weather,year}\OperatorTok{!=}\DecValTok{1995}\NormalTok{),year}\OperatorTok{<}\DecValTok{1997}\OperatorTok{|}\NormalTok{year}\OperatorTok{>}\DecValTok{2005}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# FFD mean and SD}
\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{summarySE}\NormalTok{(data_selag, }\DataTypeTok{measurevar=}\StringTok{"FFD"}\NormalTok{, }\DataTypeTok{groupvars=}\StringTok{"year"}\NormalTok{,}\DataTypeTok{na.rm=}\NormalTok{T),}
       \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{factor}\NormalTok{(year),}\DataTypeTok{y=}\NormalTok{FFD))}\OperatorTok{+}\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{size=}\DecValTok{3}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_errorbar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{ymin=}\NormalTok{FFD}\OperatorTok{-}\NormalTok{sd, }\DataTypeTok{ymax=}\NormalTok{FFD}\OperatorTok{+}\NormalTok{sd), }\DataTypeTok{width=}\NormalTok{.}\DecValTok{3}\NormalTok{)}\OperatorTok{+}\StringTok{ }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{size=}\DecValTok{3}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Year"}\NormalTok{)}\OperatorTok{+}\KeywordTok{ylab}\NormalTok{(}\StringTok{"First flowering date}\CharTok{\textbackslash{}n}\StringTok{(days after vernal equinox)"}\NormalTok{)}\OperatorTok{+}\KeywordTok{my_theme}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-72-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggsave}\NormalTok{(}\DataTypeTok{filename=}\StringTok{"C:/Users/User/Dropbox/SU/Projects/lathyrus/lathyrus_ms3/results/figures/AppendixS2_1.tiff"}\NormalTok{,}
       \DataTypeTok{device=}\StringTok{"tiff"}\NormalTok{,}\DataTypeTok{width=}\DecValTok{25}\NormalTok{,}\DataTypeTok{height=}\DecValTok{10}\NormalTok{,}\DataTypeTok{units=}\StringTok{"cm"}\NormalTok{,}\DataTypeTok{dpi=}\DecValTok{300}\NormalTok{,}\DataTypeTok{compression=}\StringTok{"lzw"}\NormalTok{)}

\CommentTok{# Temperatures}
\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{summarySE}\NormalTok{(}\KeywordTok{subset}\NormalTok{(}\KeywordTok{subset}\NormalTok{(weather,year}\OperatorTok{>}\DecValTok{1986}\NormalTok{),month}\OperatorTok{==}\DecValTok{3}\OperatorTok{|}\NormalTok{month}\OperatorTok{==}\DecValTok{4}\OperatorTok{|}\NormalTok{month}\OperatorTok{==}\DecValTok{5}\OperatorTok{|}\NormalTok{month}\OperatorTok{==}\DecValTok{6}\NormalTok{), }
                 \DataTypeTok{measurevar=}\StringTok{"mean"}\NormalTok{, }\DataTypeTok{groupvars=}\KeywordTok{c}\NormalTok{(}\StringTok{"year"}\NormalTok{,}\StringTok{"month"}\NormalTok{)),}
       \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{factor}\NormalTok{(year),}\DataTypeTok{y=}\NormalTok{mean))}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_errorbar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{ymin=}\NormalTok{mean}\OperatorTok{-}\NormalTok{se, }\DataTypeTok{ymax=}\NormalTok{mean}\OperatorTok{+}\NormalTok{se,}\DataTypeTok{color=}\KeywordTok{as.factor}\NormalTok{(month)), }\DataTypeTok{width=}\NormalTok{.}\DecValTok{3}\NormalTok{,}
                \DataTypeTok{position =} \KeywordTok{position_dodge}\NormalTok{(}\DataTypeTok{width =} \FloatTok{0.5}\NormalTok{))}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{size=}\DecValTok{3}\NormalTok{,}\DataTypeTok{position =} \KeywordTok{position_dodge}\NormalTok{(}\DataTypeTok{width =} \FloatTok{0.5}\NormalTok{),}
             \KeywordTok{aes}\NormalTok{(}\DataTypeTok{shape=}\KeywordTok{as.factor}\NormalTok{(month),}\DataTypeTok{color=}\KeywordTok{as.factor}\NormalTok{(month),}\DataTypeTok{fill=}\KeywordTok{as.factor}\NormalTok{(month)))}\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Year"}\NormalTok{)}\OperatorTok{+}\KeywordTok{ylab}\NormalTok{(}\StringTok{"Mean daily temperature (C)"}\NormalTok{)}\OperatorTok{+}\KeywordTok{my_theme}\NormalTok{()}\OperatorTok{+}\KeywordTok{scale_shape_manual}\NormalTok{(}\DataTypeTok{values=}\KeywordTok{c}\NormalTok{(}\DecValTok{21}\NormalTok{,}\DecValTok{21}\NormalTok{,}\DecValTok{21}\NormalTok{,}\DecValTok{21}\NormalTok{))}\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_manual}\NormalTok{(}\DataTypeTok{values=}\KeywordTok{c}\NormalTok{(}\StringTok{"#E69F00"}\NormalTok{, }\StringTok{"#56B4E9"}\NormalTok{, }\StringTok{"#009E73"}\NormalTok{, }\StringTok{"#F0E442"}\NormalTok{))}\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_manual}\NormalTok{(}\DataTypeTok{values=}\KeywordTok{c}\NormalTok{(}\StringTok{"#E69F00"}\NormalTok{, }\StringTok{"#56B4E9"}\NormalTok{, }\StringTok{"#009E73"}\NormalTok{, }\StringTok{"#F0E442"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-72-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggsave}\NormalTok{(}\DataTypeTok{filename=}\StringTok{"C:/Users/User/Dropbox/SU/Projects/lathyrus/lathyrus_ms3/results/figures/AppendixS2_2.tiff"}\NormalTok{,}
       \DataTypeTok{device=}\StringTok{"tiff"}\NormalTok{,}\DataTypeTok{width=}\DecValTok{25}\NormalTok{,}\DataTypeTok{height=}\DecValTok{10}\NormalTok{,}\DataTypeTok{units=}\StringTok{"cm"}\NormalTok{,}\DataTypeTok{dpi=}\DecValTok{300}\NormalTok{,}\DataTypeTok{compression=}\StringTok{"lzw"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Interactions}
\NormalTok{S2_}\DecValTok{3}\NormalTok{<-}\KeywordTok{grid.arrange}\NormalTok{(}
  \KeywordTok{ggplot}\NormalTok{(}\KeywordTok{summarySE}\NormalTok{(data_selag,}\DataTypeTok{measurevar=}\StringTok{"grazing_corr"}\NormalTok{,}\DataTypeTok{groupvars=}\StringTok{"year"}\NormalTok{,}\DataTypeTok{na.rm=}\NormalTok{T),}
         \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{factor}\NormalTok{(year),}\DataTypeTok{y=}\NormalTok{grazing_corr))}\OperatorTok{+}\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{size=}\DecValTok{3}\NormalTok{)}\OperatorTok{+}
\StringTok{    }\KeywordTok{geom_errorbar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{ymin=}\NormalTok{grazing_corr}\OperatorTok{-}\NormalTok{se,}\DataTypeTok{ymax=}\NormalTok{grazing_corr}\OperatorTok{+}\NormalTok{se), }\DataTypeTok{width=}\NormalTok{.}\DecValTok{3}\NormalTok{)}\OperatorTok{+}
\StringTok{    }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Year"}\NormalTok{)}\OperatorTok{+}\KeywordTok{ylab}\NormalTok{(}\StringTok{"Grazing"}\NormalTok{)}\OperatorTok{+}\KeywordTok{my_theme}\NormalTok{()}\OperatorTok{+}\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"A)"}\NormalTok{),}
  \KeywordTok{ggplot}\NormalTok{(}\KeywordTok{summarySE}\NormalTok{(data_selag,}\DataTypeTok{measurevar=}\StringTok{"n_seeds_per_fl"}\NormalTok{,}\DataTypeTok{groupvars=}\StringTok{"year"}\NormalTok{,}\DataTypeTok{na.rm=}\NormalTok{T),}
         \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{factor}\NormalTok{(year),}\DataTypeTok{y=}\NormalTok{n_seeds_per_fl))}\OperatorTok{+}\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{size=}\DecValTok{3}\NormalTok{)}\OperatorTok{+}
\StringTok{    }\KeywordTok{geom_errorbar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{ymin=}\NormalTok{n_seeds_per_fl}\OperatorTok{-}\NormalTok{se,}\DataTypeTok{ymax=}\NormalTok{n_seeds_per_fl}\OperatorTok{+}\NormalTok{se), }\DataTypeTok{width=}\NormalTok{.}\DecValTok{3}\NormalTok{)}\OperatorTok{+}
\StringTok{    }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Year"}\NormalTok{)}\OperatorTok{+}\KeywordTok{ylab}\NormalTok{(}\StringTok{"Number of seeds per flower"}\NormalTok{)}\OperatorTok{+}\KeywordTok{my_theme}\NormalTok{()}\OperatorTok{+}\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"B)"}\NormalTok{),}
  \KeywordTok{ggplot}\NormalTok{(}\KeywordTok{summarySE}\NormalTok{(data_selag,}\DataTypeTok{measurevar=}\StringTok{"prop_pred_seeds"}\NormalTok{,}\DataTypeTok{groupvars=}\StringTok{"year"}\NormalTok{,}\DataTypeTok{na.rm=}\NormalTok{T),}
         \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{factor}\NormalTok{(year),}\DataTypeTok{y=}\NormalTok{prop_pred_seeds))}\OperatorTok{+}\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{size=}\DecValTok{3}\NormalTok{)}\OperatorTok{+}
\StringTok{    }\KeywordTok{geom_errorbar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{ymin=}\NormalTok{prop_pred_seeds}\OperatorTok{-}\NormalTok{se,}\DataTypeTok{ymax=}\NormalTok{prop_pred_seeds}\OperatorTok{+}\NormalTok{se), }\DataTypeTok{width=}\NormalTok{.}\DecValTok{3}\NormalTok{)}\OperatorTok{+}
\StringTok{    }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Year"}\NormalTok{)}\OperatorTok{+}\KeywordTok{ylab}\NormalTok{(}\StringTok{"Seed predation"}\NormalTok{)}\OperatorTok{+}\KeywordTok{my_theme}\NormalTok{()}\OperatorTok{+}\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"C)"}\NormalTok{),}
  \DataTypeTok{ncol=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lathyrus_ms3_2_files/figure-latex/unnamed-chunk-73-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggsave}\NormalTok{(}\DataTypeTok{filename=}\StringTok{"C:/Users/User/Dropbox/SU/Projects/lathyrus/lathyrus_ms3/results/figures/AppendixS2_3.tiff"}\NormalTok{,}
       \DataTypeTok{plot=}\NormalTok{S2_}\DecValTok{3}\NormalTok{,}\DataTypeTok{device=}\StringTok{"tiff"}\NormalTok{,}\DataTypeTok{width=}\DecValTok{25}\NormalTok{,}\DataTypeTok{height=}\DecValTok{30}\NormalTok{,}\DataTypeTok{units=}\StringTok{"cm"}\NormalTok{,}\DataTypeTok{dpi=}\DecValTok{300}\NormalTok{,}\DataTypeTok{compression=}\StringTok{"lzw"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{correlation-table-predictors-table-2}{%
\section{Correlation table predictors Table
2}\label{correlation-table-predictors-table-2}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{kable}\NormalTok{(}\KeywordTok{cor}\NormalTok{(data_selag[}\KeywordTok{c}\NormalTok{(}\DecValTok{16}\OperatorTok{:}\DecValTok{20}\NormalTok{,}\DecValTok{29}\NormalTok{,}\DecValTok{32}\OperatorTok{:}\DecValTok{34}\NormalTok{)],}\DataTypeTok{use=}\StringTok{"pairwise.complete.obs"}\NormalTok{),}\DataTypeTok{digits=}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lrrrrrrrrr@{}}
\toprule
& n\_fl & mean\_3 & mean\_4 & mean\_5 & mean\_6 & grazing\_corr &
FFD\_mean & FFD\_sd & FFD\_s\_y\tabularnewline
\midrule
\endhead
n\_fl & 1.000 & 0.003 & 0.078 & 0.023 & 0.084 & 0.072 & -0.164 & 0.053 &
-0.366\tabularnewline
mean\_3 & 0.003 & 1.000 & 0.426 & 0.547 & 0.159 & 0.073 & -0.666 & 0.055
& 0.000\tabularnewline
mean\_4 & 0.078 & 0.426 & 1.000 & -0.023 & -0.190 & -0.027 & -0.371 &
0.567 & 0.000\tabularnewline
mean\_5 & 0.023 & 0.547 & -0.023 & 1.000 & 0.529 & -0.060 & -0.815 &
-0.669 & 0.000\tabularnewline
mean\_6 & 0.084 & 0.159 & -0.190 & 0.529 & 1.000 & 0.037 & -0.304 &
-0.509 & 0.000\tabularnewline
grazing\_corr & 0.072 & 0.073 & -0.027 & -0.060 & 0.037 & 1.000 & 0.001
& -0.030 & -0.110\tabularnewline
FFD\_mean & -0.164 & -0.666 & -0.371 & -0.815 & -0.304 & 0.001 & 1.000 &
0.234 & 0.000\tabularnewline
FFD\_sd & 0.053 & 0.055 & 0.567 & -0.669 & -0.509 & -0.030 & 0.234 &
1.000 & 0.000\tabularnewline
FFD\_s\_y & -0.366 & 0.000 & 0.000 & 0.000 & 0.000 & -0.110 & 0.000 &
0.000 & 1.000\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{among-year-variation-in-relationships-among-interaction-intensities-and-ffd}{%
\section{Among-year variation in relationships among interaction
intensities and
FFD}\label{among-year-variation-in-relationships-among-interaction-intensities-and-ffd}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{graz_FFD_yrs<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(grazing_success,grazing_failure)}\OperatorTok{~}\NormalTok{FFD}\OperatorTok{*}\KeywordTok{as.factor}\NormalTok{(year)}\OperatorTok{+}\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id),}
                      \DataTypeTok{data =}\NormalTok{ data_selag,}\DataTypeTok{family=}\NormalTok{betabinomial)}
\KeywordTok{Anova}\NormalTok{(graz_FFD_yrs)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: cbind(grazing_success, grazing_failure)
##                       Chisq Df Pr(>Chisq)    
## FFD                  21.764  1  3.083e-06 ***
## as.factor(year)     257.726 20  < 2.2e-16 ***
## FFD:as.factor(year)  57.191 20  1.920e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seedfl_FFD_yrs<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{round}\NormalTok{(n_seeds_per_fl)}\OperatorTok{~}\NormalTok{FFD}\OperatorTok{*}\KeywordTok{as.factor}\NormalTok{(year)}\OperatorTok{+}\NormalTok{(}\DecValTok{1}\OperatorTok{|}\NormalTok{id),}
                      \DataTypeTok{data =}\NormalTok{ data_selag,}\DataTypeTok{family=}\NormalTok{poisson)}
\KeywordTok{Anova}\NormalTok{(seedfl_FFD_yrs)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: round(n_seeds_per_fl)
##                       Chisq Df Pr(>Chisq)    
## FFD                  13.033  1  0.0003061 ***
## as.factor(year)     246.472 20  < 2.2e-16 ***
## FFD:as.factor(year)  40.681 20  0.0040923 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pred_FFD_yrs<-}\KeywordTok{glmmTMB}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(}\KeywordTok{round}\NormalTok{(n_pred_seeds),}\KeywordTok{round}\NormalTok{(n_intact_seeds))}\OperatorTok{~}\NormalTok{FFD}\OperatorTok{*}\KeywordTok{as.factor}\NormalTok{(year),}
                      \DataTypeTok{data =} \KeywordTok{subset}\NormalTok{(}\KeywordTok{subset}\NormalTok{(data_selag,n_seeds}\OperatorTok{>}\DecValTok{0}\NormalTok{),}\OperatorTok{!}\KeywordTok{is.na}\NormalTok{(n_intact_seeds)),}
                      \DataTypeTok{family=}\NormalTok{betabinomial)}
\KeywordTok{Anova}\NormalTok{(pred_FFD_yrs)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: cbind(round(n_pred_seeds), round(n_intact_seeds))
##                        Chisq Df Pr(>Chisq)    
## FFD                   0.3098  1  0.5777766    
## as.factor(year)     603.4516 20  < 2.2e-16 ***
## FFD:as.factor(year)  52.1063 20  0.0001099 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\end{document}
